{"version":3,"file":"crowdgoeswild.js","sources":["../node_modules/html-to-image/es/util.js","../node_modules/html-to-image/es/clone-pseudos.js","../node_modules/html-to-image/es/mimes.js","../node_modules/html-to-image/es/dataurl.js","../node_modules/html-to-image/es/clone-node.js","../node_modules/html-to-image/es/embed-resources.js","../node_modules/html-to-image/es/embed-images.js","../node_modules/html-to-image/es/apply-style.js","../node_modules/html-to-image/es/embed-webfonts.js","../node_modules/html-to-image/es/index.js","../src/ts/scripts/VibeCheckPopup.ts","../src/ts/scripts/socket.ts","../src/ts/scripts/events.ts","../src/ts/scripts/reactionsets.ts","../src/ts/scripts/settings.ts","../src/ts/scripts/ReactionEditor.ts","../src/ts/scripts/ReactionSetupMenu.ts","../src/ts/scripts/utils.ts","../src/ts/scripts/animation.ts","../src/ts/scripts/handlebars.ts","../src/ts/scripts/hooks.ts","../src/ts/scripts/crowdgoeswild.ts"],"sourcesContent":["export function resolveUrl(url, baseUrl) {\n    // url is absolute already\n    if (url.match(/^[a-z]+:\\/\\//i)) {\n        return url;\n    }\n    // url is absolute already, without protocol\n    if (url.match(/^\\/\\//)) {\n        return window.location.protocol + url;\n    }\n    // dataURI, mailto:, tel:, etc.\n    if (url.match(/^[a-z]+:/i)) {\n        return url;\n    }\n    const doc = document.implementation.createHTMLDocument();\n    const base = doc.createElement('base');\n    const a = doc.createElement('a');\n    doc.head.appendChild(base);\n    doc.body.appendChild(a);\n    if (baseUrl) {\n        base.href = baseUrl;\n    }\n    a.href = url;\n    return a.href;\n}\nexport const uuid = (() => {\n    // generate uuid for className of pseudo elements.\n    // We should not use GUIDs, otherwise pseudo elements sometimes cannot be captured.\n    let counter = 0;\n    // ref: http://stackoverflow.com/a/6248722/2519373\n    const random = () => \n    // eslint-disable-next-line no-bitwise\n    `0000${((Math.random() * 36 ** 4) << 0).toString(36)}`.slice(-4);\n    return () => {\n        counter += 1;\n        return `u${random()}${counter}`;\n    };\n})();\nexport function delay(ms) {\n    return (args) => new Promise((resolve) => {\n        setTimeout(() => resolve(args), ms);\n    });\n}\nexport function toArray(arrayLike) {\n    const arr = [];\n    for (let i = 0, l = arrayLike.length; i < l; i++) {\n        arr.push(arrayLike[i]);\n    }\n    return arr;\n}\nfunction px(node, styleProperty) {\n    const win = node.ownerDocument.defaultView || window;\n    const val = win.getComputedStyle(node).getPropertyValue(styleProperty);\n    return val ? parseFloat(val.replace('px', '')) : 0;\n}\nfunction getNodeWidth(node) {\n    const leftBorder = px(node, 'border-left-width');\n    const rightBorder = px(node, 'border-right-width');\n    return node.clientWidth + leftBorder + rightBorder;\n}\nfunction getNodeHeight(node) {\n    const topBorder = px(node, 'border-top-width');\n    const bottomBorder = px(node, 'border-bottom-width');\n    return node.clientHeight + topBorder + bottomBorder;\n}\nexport function getImageSize(targetNode, options = {}) {\n    const width = options.width || getNodeWidth(targetNode);\n    const height = options.height || getNodeHeight(targetNode);\n    return { width, height };\n}\nexport function getPixelRatio() {\n    let ratio;\n    let FINAL_PROCESS;\n    try {\n        FINAL_PROCESS = process;\n    }\n    catch (e) {\n        // pass\n    }\n    const val = FINAL_PROCESS && FINAL_PROCESS.env\n        ? FINAL_PROCESS.env.devicePixelRatio\n        : null;\n    if (val) {\n        ratio = parseInt(val, 10);\n        if (Number.isNaN(ratio)) {\n            ratio = 1;\n        }\n    }\n    return ratio || window.devicePixelRatio || 1;\n}\n// @see https://developer.mozilla.org/en-US/docs/Web/HTML/Element/canvas#maximum_canvas_size\nconst canvasDimensionLimit = 16384;\nexport function checkCanvasDimensions(canvas) {\n    if (canvas.width > canvasDimensionLimit ||\n        canvas.height > canvasDimensionLimit) {\n        if (canvas.width > canvasDimensionLimit &&\n            canvas.height > canvasDimensionLimit) {\n            if (canvas.width > canvas.height) {\n                canvas.height *= canvasDimensionLimit / canvas.width;\n                canvas.width = canvasDimensionLimit;\n            }\n            else {\n                canvas.width *= canvasDimensionLimit / canvas.height;\n                canvas.height = canvasDimensionLimit;\n            }\n        }\n        else if (canvas.width > canvasDimensionLimit) {\n            canvas.height *= canvasDimensionLimit / canvas.width;\n            canvas.width = canvasDimensionLimit;\n        }\n        else {\n            canvas.width *= canvasDimensionLimit / canvas.height;\n            canvas.height = canvasDimensionLimit;\n        }\n    }\n}\nexport function canvasToBlob(canvas, options = {}) {\n    if (canvas.toBlob) {\n        return new Promise((resolve) => {\n            canvas.toBlob(resolve, options.type ? options.type : 'image/png', options.quality ? options.quality : 1);\n        });\n    }\n    return new Promise((resolve) => {\n        const binaryString = window.atob(canvas\n            .toDataURL(options.type ? options.type : undefined, options.quality ? options.quality : undefined)\n            .split(',')[1]);\n        const len = binaryString.length;\n        const binaryArray = new Uint8Array(len);\n        for (let i = 0; i < len; i += 1) {\n            binaryArray[i] = binaryString.charCodeAt(i);\n        }\n        resolve(new Blob([binaryArray], {\n            type: options.type ? options.type : 'image/png',\n        }));\n    });\n}\nexport function createImage(url) {\n    return new Promise((resolve, reject) => {\n        const img = new Image();\n        img.decode = () => resolve(img);\n        img.onload = () => resolve(img);\n        img.onerror = reject;\n        img.crossOrigin = 'anonymous';\n        img.decoding = 'async';\n        img.src = url;\n    });\n}\nexport async function svgToDataURL(svg) {\n    return Promise.resolve()\n        .then(() => new XMLSerializer().serializeToString(svg))\n        .then(encodeURIComponent)\n        .then((html) => `data:image/svg+xml;charset=utf-8,${html}`);\n}\nexport async function nodeToDataURL(node, width, height) {\n    const xmlns = 'http://www.w3.org/2000/svg';\n    const svg = document.createElementNS(xmlns, 'svg');\n    const foreignObject = document.createElementNS(xmlns, 'foreignObject');\n    svg.setAttribute('width', `${width}`);\n    svg.setAttribute('height', `${height}`);\n    svg.setAttribute('viewBox', `0 0 ${width} ${height}`);\n    foreignObject.setAttribute('width', '100%');\n    foreignObject.setAttribute('height', '100%');\n    foreignObject.setAttribute('x', '0');\n    foreignObject.setAttribute('y', '0');\n    foreignObject.setAttribute('externalResourcesRequired', 'true');\n    svg.appendChild(foreignObject);\n    foreignObject.appendChild(node);\n    return svgToDataURL(svg);\n}\nexport const isInstanceOfElement = (node, instance) => {\n    if (node instanceof instance)\n        return true;\n    const nodePrototype = Object.getPrototypeOf(node);\n    if (nodePrototype === null)\n        return false;\n    return (nodePrototype.constructor.name === instance.name ||\n        isInstanceOfElement(nodePrototype, instance));\n};\n//# sourceMappingURL=util.js.map","import { uuid, toArray } from './util';\nfunction formatCSSText(style) {\n    const content = style.getPropertyValue('content');\n    return `${style.cssText} content: '${content.replace(/'|\"/g, '')}';`;\n}\nfunction formatCSSProperties(style) {\n    return toArray(style)\n        .map((name) => {\n        const value = style.getPropertyValue(name);\n        const priority = style.getPropertyPriority(name);\n        return `${name}: ${value}${priority ? ' !important' : ''};`;\n    })\n        .join(' ');\n}\nfunction getPseudoElementStyle(className, pseudo, style) {\n    const selector = `.${className}:${pseudo}`;\n    const cssText = style.cssText\n        ? formatCSSText(style)\n        : formatCSSProperties(style);\n    return document.createTextNode(`${selector}{${cssText}}`);\n}\nfunction clonePseudoElement(nativeNode, clonedNode, pseudo) {\n    const style = window.getComputedStyle(nativeNode, pseudo);\n    const content = style.getPropertyValue('content');\n    if (content === '' || content === 'none') {\n        return;\n    }\n    const className = uuid();\n    try {\n        clonedNode.className = `${clonedNode.className} ${className}`;\n    }\n    catch (err) {\n        return;\n    }\n    const styleElement = document.createElement('style');\n    styleElement.appendChild(getPseudoElementStyle(className, pseudo, style));\n    clonedNode.appendChild(styleElement);\n}\nexport function clonePseudoElements(nativeNode, clonedNode) {\n    clonePseudoElement(nativeNode, clonedNode, ':before');\n    clonePseudoElement(nativeNode, clonedNode, ':after');\n}\n//# sourceMappingURL=clone-pseudos.js.map","const WOFF = 'application/font-woff';\nconst JPEG = 'image/jpeg';\nconst mimes = {\n    woff: WOFF,\n    woff2: WOFF,\n    ttf: 'application/font-truetype',\n    eot: 'application/vnd.ms-fontobject',\n    png: 'image/png',\n    jpg: JPEG,\n    jpeg: JPEG,\n    gif: 'image/gif',\n    tiff: 'image/tiff',\n    svg: 'image/svg+xml',\n    webp: 'image/webp',\n};\nfunction getExtension(url) {\n    const match = /\\.([^./]*?)$/g.exec(url);\n    return match ? match[1] : '';\n}\nexport function getMimeType(url) {\n    const extension = getExtension(url).toLowerCase();\n    return mimes[extension] || '';\n}\n//# sourceMappingURL=mimes.js.map","function getContentFromDataUrl(dataURL) {\n    return dataURL.split(/,/)[1];\n}\nexport function isDataUrl(url) {\n    return url.search(/^(data:)/) !== -1;\n}\nexport function makeDataUrl(content, mimeType) {\n    return `data:${mimeType};base64,${content}`;\n}\nexport async function fetchAsDataURL(url, init, process) {\n    const res = await fetch(url, init);\n    if (res.status === 404) {\n        throw new Error(`Resource \"${res.url}\" not found`);\n    }\n    const blob = await res.blob();\n    return new Promise((resolve, reject) => {\n        const reader = new FileReader();\n        reader.onerror = reject;\n        reader.onloadend = () => {\n            try {\n                resolve(process({ res, result: reader.result }));\n            }\n            catch (error) {\n                reject(error);\n            }\n        };\n        reader.readAsDataURL(blob);\n    });\n}\nconst cache = {};\nfunction getCacheKey(url, contentType, includeQueryParams) {\n    let key = url.replace(/\\?.*/, '');\n    if (includeQueryParams) {\n        key = url;\n    }\n    // font resource\n    if (/ttf|otf|eot|woff2?/i.test(key)) {\n        key = key.replace(/.*\\//, '');\n    }\n    return contentType ? `[${contentType}]${key}` : key;\n}\nexport async function resourceToDataURL(resourceUrl, contentType, options) {\n    const cacheKey = getCacheKey(resourceUrl, contentType, options.includeQueryParams);\n    if (cache[cacheKey] != null) {\n        return cache[cacheKey];\n    }\n    // ref: https://developer.mozilla.org/en/docs/Web/API/XMLHttpRequest/Using_XMLHttpRequest#Bypassing_the_cache\n    if (options.cacheBust) {\n        // eslint-disable-next-line no-param-reassign\n        resourceUrl += (/\\?/.test(resourceUrl) ? '&' : '?') + new Date().getTime();\n    }\n    let dataURL;\n    try {\n        const content = await fetchAsDataURL(resourceUrl, options.fetchRequestInit, ({ res, result }) => {\n            if (!contentType) {\n                // eslint-disable-next-line no-param-reassign\n                contentType = res.headers.get('Content-Type') || '';\n            }\n            return getContentFromDataUrl(result);\n        });\n        dataURL = makeDataUrl(content, contentType);\n    }\n    catch (error) {\n        dataURL = options.imagePlaceholder || '';\n        let msg = `Failed to fetch resource: ${resourceUrl}`;\n        if (error) {\n            msg = typeof error === 'string' ? error : error.message;\n        }\n        if (msg) {\n            console.warn(msg);\n        }\n    }\n    cache[cacheKey] = dataURL;\n    return dataURL;\n}\n//# sourceMappingURL=dataurl.js.map","import { clonePseudoElements } from './clone-pseudos';\nimport { createImage, toArray, isInstanceOfElement } from './util';\nimport { getMimeType } from './mimes';\nimport { resourceToDataURL } from './dataurl';\nasync function cloneCanvasElement(canvas) {\n    const dataURL = canvas.toDataURL();\n    if (dataURL === 'data:,') {\n        return canvas.cloneNode(false);\n    }\n    return createImage(dataURL);\n}\nasync function cloneVideoElement(video, options) {\n    if (video.currentSrc) {\n        const canvas = document.createElement('canvas');\n        const ctx = canvas.getContext('2d');\n        canvas.width = video.clientWidth;\n        canvas.height = video.clientHeight;\n        ctx === null || ctx === void 0 ? void 0 : ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n        const dataURL = canvas.toDataURL();\n        return createImage(dataURL);\n    }\n    const poster = video.poster;\n    const contentType = getMimeType(poster);\n    const dataURL = await resourceToDataURL(poster, contentType, options);\n    return createImage(dataURL);\n}\nasync function cloneIFrameElement(iframe) {\n    var _a;\n    try {\n        if ((_a = iframe === null || iframe === void 0 ? void 0 : iframe.contentDocument) === null || _a === void 0 ? void 0 : _a.body) {\n            return (await cloneNode(iframe.contentDocument.body, {}, true));\n        }\n    }\n    catch (_b) {\n        // Failed to clone iframe\n    }\n    return iframe.cloneNode(false);\n}\nasync function cloneSingleNode(node, options) {\n    if (isInstanceOfElement(node, HTMLCanvasElement)) {\n        return cloneCanvasElement(node);\n    }\n    if (isInstanceOfElement(node, HTMLVideoElement)) {\n        return cloneVideoElement(node, options);\n    }\n    if (isInstanceOfElement(node, HTMLIFrameElement)) {\n        return cloneIFrameElement(node);\n    }\n    return node.cloneNode(false);\n}\nconst isSlotElement = (node) => node.tagName != null && node.tagName.toUpperCase() === 'SLOT';\nasync function cloneChildren(nativeNode, clonedNode, options) {\n    var _a, _b;\n    let children = [];\n    if (isSlotElement(nativeNode) && nativeNode.assignedNodes) {\n        children = toArray(nativeNode.assignedNodes());\n    }\n    else if (isInstanceOfElement(nativeNode, HTMLIFrameElement) &&\n        ((_a = nativeNode.contentDocument) === null || _a === void 0 ? void 0 : _a.body)) {\n        children = toArray(nativeNode.contentDocument.body.childNodes);\n    }\n    else {\n        children = toArray(((_b = nativeNode.shadowRoot) !== null && _b !== void 0 ? _b : nativeNode).childNodes);\n    }\n    if (children.length === 0 ||\n        isInstanceOfElement(nativeNode, HTMLVideoElement)) {\n        return clonedNode;\n    }\n    await children.reduce((deferred, child) => deferred\n        .then(() => cloneNode(child, options))\n        .then((clonedChild) => {\n        if (clonedChild) {\n            clonedNode.appendChild(clonedChild);\n        }\n    }), Promise.resolve());\n    return clonedNode;\n}\nfunction cloneCSSStyle(nativeNode, clonedNode) {\n    const targetStyle = clonedNode.style;\n    if (!targetStyle) {\n        return;\n    }\n    const sourceStyle = window.getComputedStyle(nativeNode);\n    if (sourceStyle.cssText) {\n        targetStyle.cssText = sourceStyle.cssText;\n        targetStyle.transformOrigin = sourceStyle.transformOrigin;\n    }\n    else {\n        toArray(sourceStyle).forEach((name) => {\n            let value = sourceStyle.getPropertyValue(name);\n            if (name === 'font-size' && value.endsWith('px')) {\n                const reducedFont = Math.floor(parseFloat(value.substring(0, value.length - 2))) - 0.1;\n                value = `${reducedFont}px`;\n            }\n            if (isInstanceOfElement(nativeNode, HTMLIFrameElement) &&\n                name === 'display' &&\n                value === 'inline') {\n                value = 'block';\n            }\n            if (name === 'd' && clonedNode.getAttribute('d')) {\n                value = `path(${clonedNode.getAttribute('d')})`;\n            }\n            targetStyle.setProperty(name, value, sourceStyle.getPropertyPriority(name));\n        });\n    }\n}\nfunction cloneInputValue(nativeNode, clonedNode) {\n    if (isInstanceOfElement(nativeNode, HTMLTextAreaElement)) {\n        clonedNode.innerHTML = nativeNode.value;\n    }\n    if (isInstanceOfElement(nativeNode, HTMLInputElement)) {\n        clonedNode.setAttribute('value', nativeNode.value);\n    }\n}\nfunction cloneSelectValue(nativeNode, clonedNode) {\n    if (isInstanceOfElement(nativeNode, HTMLSelectElement)) {\n        const clonedSelect = clonedNode;\n        const selectedOption = Array.from(clonedSelect.children).find((child) => nativeNode.value === child.getAttribute('value'));\n        if (selectedOption) {\n            selectedOption.setAttribute('selected', '');\n        }\n    }\n}\nfunction decorate(nativeNode, clonedNode) {\n    if (isInstanceOfElement(clonedNode, Element)) {\n        cloneCSSStyle(nativeNode, clonedNode);\n        clonePseudoElements(nativeNode, clonedNode);\n        cloneInputValue(nativeNode, clonedNode);\n        cloneSelectValue(nativeNode, clonedNode);\n    }\n    return clonedNode;\n}\nasync function ensureSVGSymbols(clone, options) {\n    const uses = clone.querySelectorAll ? clone.querySelectorAll('use') : [];\n    if (uses.length === 0) {\n        return clone;\n    }\n    const processedDefs = {};\n    for (let i = 0; i < uses.length; i++) {\n        const use = uses[i];\n        const id = use.getAttribute('xlink:href');\n        if (id) {\n            const exist = clone.querySelector(id);\n            const definition = document.querySelector(id);\n            if (!exist && definition && !processedDefs[id]) {\n                // eslint-disable-next-line no-await-in-loop\n                processedDefs[id] = (await cloneNode(definition, options, true));\n            }\n        }\n    }\n    const nodes = Object.values(processedDefs);\n    if (nodes.length) {\n        const ns = 'http://www.w3.org/1999/xhtml';\n        const svg = document.createElementNS(ns, 'svg');\n        svg.setAttribute('xmlns', ns);\n        svg.style.position = 'absolute';\n        svg.style.width = '0';\n        svg.style.height = '0';\n        svg.style.overflow = 'hidden';\n        svg.style.display = 'none';\n        const defs = document.createElementNS(ns, 'defs');\n        svg.appendChild(defs);\n        for (let i = 0; i < nodes.length; i++) {\n            defs.appendChild(nodes[i]);\n        }\n        clone.appendChild(svg);\n    }\n    return clone;\n}\nexport async function cloneNode(node, options, isRoot) {\n    if (!isRoot && options.filter && !options.filter(node)) {\n        return null;\n    }\n    return Promise.resolve(node)\n        .then((clonedNode) => cloneSingleNode(clonedNode, options))\n        .then((clonedNode) => cloneChildren(node, clonedNode, options))\n        .then((clonedNode) => decorate(node, clonedNode))\n        .then((clonedNode) => ensureSVGSymbols(clonedNode, options));\n}\n//# sourceMappingURL=clone-node.js.map","import { resolveUrl } from './util';\nimport { getMimeType } from './mimes';\nimport { isDataUrl, makeDataUrl, resourceToDataURL } from './dataurl';\nconst URL_REGEX = /url\\((['\"]?)([^'\"]+?)\\1\\)/g;\nconst URL_WITH_FORMAT_REGEX = /url\\([^)]+\\)\\s*format\\(([\"']?)([^\"']+)\\1\\)/g;\nconst FONT_SRC_REGEX = /src:\\s*(?:url\\([^)]+\\)\\s*format\\([^)]+\\)[,;]\\s*)+/g;\nfunction toRegex(url) {\n    // eslint-disable-next-line no-useless-escape\n    const escaped = url.replace(/([.*+?^${}()|\\[\\]\\/\\\\])/g, '\\\\$1');\n    return new RegExp(`(url\\\\(['\"]?)(${escaped})(['\"]?\\\\))`, 'g');\n}\nexport function parseURLs(cssText) {\n    const urls = [];\n    cssText.replace(URL_REGEX, (raw, quotation, url) => {\n        urls.push(url);\n        return raw;\n    });\n    return urls.filter((url) => !isDataUrl(url));\n}\nexport async function embed(cssText, resourceURL, baseURL, options, getContentFromUrl) {\n    try {\n        const resolvedURL = baseURL ? resolveUrl(resourceURL, baseURL) : resourceURL;\n        const contentType = getMimeType(resourceURL);\n        let dataURL;\n        if (getContentFromUrl) {\n            const content = await getContentFromUrl(resolvedURL);\n            dataURL = makeDataUrl(content, contentType);\n        }\n        else {\n            dataURL = await resourceToDataURL(resolvedURL, contentType, options);\n        }\n        return cssText.replace(toRegex(resourceURL), `$1${dataURL}$3`);\n    }\n    catch (error) {\n        // pass\n    }\n    return cssText;\n}\nfunction filterPreferredFontFormat(str, { preferredFontFormat }) {\n    return !preferredFontFormat\n        ? str\n        : str.replace(FONT_SRC_REGEX, (match) => {\n            // eslint-disable-next-line no-constant-condition\n            while (true) {\n                const [src, , format] = URL_WITH_FORMAT_REGEX.exec(match) || [];\n                if (!format) {\n                    return '';\n                }\n                if (format === preferredFontFormat) {\n                    return `src: ${src};`;\n                }\n            }\n        });\n}\nexport function shouldEmbed(url) {\n    return url.search(URL_REGEX) !== -1;\n}\nexport async function embedResources(cssText, baseUrl, options) {\n    if (!shouldEmbed(cssText)) {\n        return cssText;\n    }\n    const filteredCSSText = filterPreferredFontFormat(cssText, options);\n    const urls = parseURLs(filteredCSSText);\n    return urls.reduce((deferred, url) => deferred.then((css) => embed(css, url, baseUrl, options)), Promise.resolve(filteredCSSText));\n}\n//# sourceMappingURL=embed-resources.js.map","import { embedResources } from './embed-resources';\nimport { toArray, isInstanceOfElement } from './util';\nimport { isDataUrl, resourceToDataURL } from './dataurl';\nimport { getMimeType } from './mimes';\nasync function embedProp(propName, node, options) {\n    var _a;\n    const propValue = (_a = node.style) === null || _a === void 0 ? void 0 : _a.getPropertyValue(propName);\n    if (propValue) {\n        const cssString = await embedResources(propValue, null, options);\n        node.style.setProperty(propName, cssString, node.style.getPropertyPriority(propName));\n        return true;\n    }\n    return false;\n}\nasync function embedBackground(clonedNode, options) {\n    if (!(await embedProp('background', clonedNode, options))) {\n        await embedProp('background-image', clonedNode, options);\n    }\n    if (!(await embedProp('mask', clonedNode, options))) {\n        await embedProp('mask-image', clonedNode, options);\n    }\n}\nasync function embedImageNode(clonedNode, options) {\n    const isImageElement = isInstanceOfElement(clonedNode, HTMLImageElement);\n    if (!(isImageElement && !isDataUrl(clonedNode.src)) &&\n        !(isInstanceOfElement(clonedNode, SVGImageElement) &&\n            !isDataUrl(clonedNode.href.baseVal))) {\n        return;\n    }\n    const url = isImageElement ? clonedNode.src : clonedNode.href.baseVal;\n    const dataURL = await resourceToDataURL(url, getMimeType(url), options);\n    await new Promise((resolve, reject) => {\n        clonedNode.onload = resolve;\n        clonedNode.onerror = reject;\n        const image = clonedNode;\n        if (image.decode) {\n            image.decode = resolve;\n        }\n        if (image.loading === 'lazy') {\n            image.loading = 'eager';\n        }\n        if (isImageElement) {\n            clonedNode.srcset = '';\n            clonedNode.src = dataURL;\n        }\n        else {\n            clonedNode.href.baseVal = dataURL;\n        }\n    });\n}\nasync function embedChildren(clonedNode, options) {\n    const children = toArray(clonedNode.childNodes);\n    const deferreds = children.map((child) => embedImages(child, options));\n    await Promise.all(deferreds).then(() => clonedNode);\n}\nexport async function embedImages(clonedNode, options) {\n    if (isInstanceOfElement(clonedNode, Element)) {\n        await embedBackground(clonedNode, options);\n        await embedImageNode(clonedNode, options);\n        await embedChildren(clonedNode, options);\n    }\n}\n//# sourceMappingURL=embed-images.js.map","export function applyStyle(node, options) {\n    const { style } = node;\n    if (options.backgroundColor) {\n        style.backgroundColor = options.backgroundColor;\n    }\n    if (options.width) {\n        style.width = `${options.width}px`;\n    }\n    if (options.height) {\n        style.height = `${options.height}px`;\n    }\n    const manual = options.style;\n    if (manual != null) {\n        Object.keys(manual).forEach((key) => {\n            style[key] = manual[key];\n        });\n    }\n    return node;\n}\n//# sourceMappingURL=apply-style.js.map","import { toArray } from './util';\nimport { fetchAsDataURL } from './dataurl';\nimport { shouldEmbed, embedResources } from './embed-resources';\nconst cssFetchCache = {};\nasync function fetchCSS(url) {\n    let cache = cssFetchCache[url];\n    if (cache != null) {\n        return cache;\n    }\n    const res = await fetch(url);\n    const cssText = await res.text();\n    cache = { url, cssText };\n    cssFetchCache[url] = cache;\n    return cache;\n}\nasync function embedFonts(data, options) {\n    let cssText = data.cssText;\n    const regexUrl = /url\\([\"']?([^\"')]+)[\"']?\\)/g;\n    const fontLocs = cssText.match(/url\\([^)]+\\)/g) || [];\n    const loadFonts = fontLocs.map(async (loc) => {\n        let url = loc.replace(regexUrl, '$1');\n        if (!url.startsWith('https://')) {\n            url = new URL(url, data.url).href;\n        }\n        return fetchAsDataURL(url, options.fetchRequestInit, ({ result }) => {\n            cssText = cssText.replace(loc, `url(${result})`);\n            return [loc, result];\n        });\n    });\n    return Promise.all(loadFonts).then(() => cssText);\n}\nfunction parseCSS(source) {\n    if (source == null) {\n        return [];\n    }\n    const result = [];\n    const commentsRegex = /(\\/\\*[\\s\\S]*?\\*\\/)/gi;\n    // strip out comments\n    let cssText = source.replace(commentsRegex, '');\n    // eslint-disable-next-line prefer-regex-literals\n    const keyframesRegex = new RegExp('((@.*?keyframes [\\\\s\\\\S]*?){([\\\\s\\\\S]*?}\\\\s*?)})', 'gi');\n    // eslint-disable-next-line no-constant-condition\n    while (true) {\n        const matches = keyframesRegex.exec(cssText);\n        if (matches === null) {\n            break;\n        }\n        result.push(matches[0]);\n    }\n    cssText = cssText.replace(keyframesRegex, '');\n    const importRegex = /@import[\\s\\S]*?url\\([^)]*\\)[\\s\\S]*?;/gi;\n    // to match css & media queries together\n    const combinedCSSRegex = '((\\\\s*?(?:\\\\/\\\\*[\\\\s\\\\S]*?\\\\*\\\\/)?\\\\s*?@media[\\\\s\\\\S]' +\n        '*?){([\\\\s\\\\S]*?)}\\\\s*?})|(([\\\\s\\\\S]*?){([\\\\s\\\\S]*?)})';\n    // unified regex\n    const unifiedRegex = new RegExp(combinedCSSRegex, 'gi');\n    // eslint-disable-next-line no-constant-condition\n    while (true) {\n        let matches = importRegex.exec(cssText);\n        if (matches === null) {\n            matches = unifiedRegex.exec(cssText);\n            if (matches === null) {\n                break;\n            }\n            else {\n                importRegex.lastIndex = unifiedRegex.lastIndex;\n            }\n        }\n        else {\n            unifiedRegex.lastIndex = importRegex.lastIndex;\n        }\n        result.push(matches[0]);\n    }\n    return result;\n}\nasync function getCSSRules(styleSheets, options) {\n    const ret = [];\n    const deferreds = [];\n    // First loop inlines imports\n    styleSheets.forEach((sheet) => {\n        if ('cssRules' in sheet) {\n            try {\n                toArray(sheet.cssRules || []).forEach((item, index) => {\n                    if (item.type === CSSRule.IMPORT_RULE) {\n                        let importIndex = index + 1;\n                        const url = item.href;\n                        const deferred = fetchCSS(url)\n                            .then((metadata) => embedFonts(metadata, options))\n                            .then((cssText) => parseCSS(cssText).forEach((rule) => {\n                            try {\n                                sheet.insertRule(rule, rule.startsWith('@import')\n                                    ? (importIndex += 1)\n                                    : sheet.cssRules.length);\n                            }\n                            catch (error) {\n                                console.error('Error inserting rule from remote css', {\n                                    rule,\n                                    error,\n                                });\n                            }\n                        }))\n                            .catch((e) => {\n                            console.error('Error loading remote css', e.toString());\n                        });\n                        deferreds.push(deferred);\n                    }\n                });\n            }\n            catch (e) {\n                const inline = styleSheets.find((a) => a.href == null) || document.styleSheets[0];\n                if (sheet.href != null) {\n                    deferreds.push(fetchCSS(sheet.href)\n                        .then((metadata) => embedFonts(metadata, options))\n                        .then((cssText) => parseCSS(cssText).forEach((rule) => {\n                        inline.insertRule(rule, sheet.cssRules.length);\n                    }))\n                        .catch((err) => {\n                        console.error('Error loading remote stylesheet', err);\n                    }));\n                }\n                console.error('Error inlining remote css file', e);\n            }\n        }\n    });\n    return Promise.all(deferreds).then(() => {\n        // Second loop parses rules\n        styleSheets.forEach((sheet) => {\n            if ('cssRules' in sheet) {\n                try {\n                    toArray(sheet.cssRules || []).forEach((item) => {\n                        ret.push(item);\n                    });\n                }\n                catch (e) {\n                    console.error(`Error while reading CSS rules from ${sheet.href}`, e);\n                }\n            }\n        });\n        return ret;\n    });\n}\nfunction getWebFontRules(cssRules) {\n    return cssRules\n        .filter((rule) => rule.type === CSSRule.FONT_FACE_RULE)\n        .filter((rule) => shouldEmbed(rule.style.getPropertyValue('src')));\n}\nasync function parseWebFontRules(node, options) {\n    if (node.ownerDocument == null) {\n        throw new Error('Provided element is not within a Document');\n    }\n    const styleSheets = toArray(node.ownerDocument.styleSheets);\n    const cssRules = await getCSSRules(styleSheets, options);\n    return getWebFontRules(cssRules);\n}\nexport async function getWebFontCSS(node, options) {\n    const rules = await parseWebFontRules(node, options);\n    const cssTexts = await Promise.all(rules.map((rule) => {\n        const baseUrl = rule.parentStyleSheet ? rule.parentStyleSheet.href : null;\n        return embedResources(rule.cssText, baseUrl, options);\n    }));\n    return cssTexts.join('\\n');\n}\nexport async function embedWebFonts(clonedNode, options) {\n    const cssText = options.fontEmbedCSS != null\n        ? options.fontEmbedCSS\n        : options.skipFonts\n            ? null\n            : await getWebFontCSS(clonedNode, options);\n    if (cssText) {\n        const styleNode = document.createElement('style');\n        const sytleContent = document.createTextNode(cssText);\n        styleNode.appendChild(sytleContent);\n        if (clonedNode.firstChild) {\n            clonedNode.insertBefore(styleNode, clonedNode.firstChild);\n        }\n        else {\n            clonedNode.appendChild(styleNode);\n        }\n    }\n}\n//# sourceMappingURL=embed-webfonts.js.map","import { cloneNode } from './clone-node';\nimport { embedImages } from './embed-images';\nimport { applyStyle } from './apply-style';\nimport { embedWebFonts, getWebFontCSS } from './embed-webfonts';\nimport { getImageSize, getPixelRatio, createImage, canvasToBlob, nodeToDataURL, checkCanvasDimensions, } from './util';\nexport async function toSvg(node, options = {}) {\n    const { width, height } = getImageSize(node, options);\n    const clonedNode = (await cloneNode(node, options, true));\n    await embedWebFonts(clonedNode, options);\n    await embedImages(clonedNode, options);\n    applyStyle(clonedNode, options);\n    const datauri = await nodeToDataURL(clonedNode, width, height);\n    return datauri;\n}\nexport async function toCanvas(node, options = {}) {\n    const { width, height } = getImageSize(node, options);\n    const svg = await toSvg(node, options);\n    const img = await createImage(svg);\n    const canvas = document.createElement('canvas');\n    const context = canvas.getContext('2d');\n    const ratio = options.pixelRatio || getPixelRatio();\n    const canvasWidth = options.canvasWidth || width;\n    const canvasHeight = options.canvasHeight || height;\n    canvas.width = canvasWidth * ratio;\n    canvas.height = canvasHeight * ratio;\n    if (!options.skipAutoScale) {\n        checkCanvasDimensions(canvas);\n    }\n    canvas.style.width = `${canvasWidth}`;\n    canvas.style.height = `${canvasHeight}`;\n    if (options.backgroundColor) {\n        context.fillStyle = options.backgroundColor;\n        context.fillRect(0, 0, canvas.width, canvas.height);\n    }\n    context.drawImage(img, 0, 0, canvas.width, canvas.height);\n    return canvas;\n}\nexport async function toPixelData(node, options = {}) {\n    const { width, height } = getImageSize(node, options);\n    const canvas = await toCanvas(node, options);\n    const ctx = canvas.getContext('2d');\n    return ctx.getImageData(0, 0, width, height).data;\n}\nexport async function toPng(node, options = {}) {\n    const canvas = await toCanvas(node, options);\n    return canvas.toDataURL();\n}\nexport async function toJpeg(node, options = {}) {\n    const canvas = await toCanvas(node, options);\n    return canvas.toDataURL('image/jpeg', options.quality || 1);\n}\nexport async function toBlob(node, options = {}) {\n    const canvas = await toCanvas(node, options);\n    const blob = await canvasToBlob(canvas);\n    return blob;\n}\nexport async function getFontEmbedCSS(node, options = {}) {\n    return getWebFontCSS(node, options);\n}\n//# sourceMappingURL=index.js.map","import { id as moduleId } from \"../../../public/module.json\";\r\nimport { sendVibeCheckResponse } from \"./socket\";\r\nimport { getReactionObject } from \"./utils\";\r\n\r\ntype userResponse = {\r\n  user: {};\r\n  response: Number;\r\n};\r\n\r\nexport default class VibeCheckPopup extends Application {\r\n  static instance;\r\n  userResponses: userResponse[] = [];\r\n\r\n  static getInstance() {\r\n    if (!this.instance) {\r\n      this.instance = new VibeCheckPopup();\r\n    }\r\n\r\n    return this.instance;\r\n  }\r\n\r\n  /**\r\n   * override\r\n   */\r\n  static get defaultOptions() {\r\n    return mergeObject(super.defaultOptions, {\r\n      classes: [\"form\", \"crowdgoeswild\", \"vibecheck\"],\r\n      popOut: true,\r\n      template: `modules/${moduleId}/templates/VibeCheckPopup.hbs`,\r\n      id: `${moduleId}-vibe-check`,\r\n      title: \"CrowdGoesWild - Vibe Check\",\r\n      width: 600,\r\n      // height: game.user.isGM ? 600 : \"auto\",\r\n      height: \"auto\",\r\n    });\r\n  }\r\n\r\n  async getData(): object | Promise<object> {\r\n    let users = await game.users.players.filter((u) => u.active);\r\n\r\n    //group the responses by user for display. Variable naming is awful here.\r\n    let groupedResponses = [];\r\n    for (const user of users) {\r\n      let filteredResponses = [];\r\n      for (const sentResponse of this.userResponses) {\r\n        if (sentResponse.user._id == user.id) {\r\n          filteredResponses.push(sentResponse.response);\r\n        }\r\n      }\r\n\r\n      let userCharacter = await user.character;\r\n      if (userCharacter) {\r\n        user.image = userCharacter.img;\r\n      } else {\r\n        user.image = user.avatar;\r\n      }\r\n\r\n      let userResponses = {\r\n        user: user,\r\n        responses: filteredResponses,\r\n      };\r\n\r\n      groupedResponses.push(userResponses);\r\n    }\r\n\r\n    let data = {\r\n      isGM: game.user.isGM,\r\n      reactions: await game.settings.get(moduleId, \"reactions\"),\r\n      responses: this.userResponses,\r\n      groupedResponses: groupedResponses,\r\n    };\r\n\r\n    return data;\r\n  }\r\n\r\n  activateListeners(html: JQuery<HTMLElement>): void {\r\n    html.find(\"button.reaction\").on(\"click\", (ev) => {\r\n      sendVibeCheckResponse(game.user, ev.currentTarget.dataset.id);\r\n      this.close();\r\n    });\r\n\r\n    $(document).off(\"keyup.cgw-vibecheck\");\r\n    $(document).on(\"keyup.cgw-vibecheck\", (ev) => {\r\n      let key = parseInt(ev.key);\r\n      if (key >= 1 && key <= 6) {\r\n        console.log(key, key >= 1 && key <= 6);\r\n        sendVibeCheckResponse(game.user, key - 1);\r\n        this.close();\r\n      }\r\n    });\r\n  }\r\n\r\n  async close(options?: Application.CloseOptions): Promise<void> {\r\n    $(document).off(\"keyup.cgw-vibecheck\");\r\n    super.close();\r\n  }\r\n}\r\n\r\nexport async function recordVibeCheckResponse(response) {\r\n  let vc = VibeCheckPopup.getInstance();\r\n  let reaction = await getReactionObject(response.response);\r\n  let user = response.user;\r\n  response = {\r\n    user: user,\r\n    response: reaction,\r\n  };\r\n  vc.userResponses.push(response);\r\n  vc.render(false);\r\n}\r\n","import { insertSentReaction, displayVibeCheck } from \"./events\";\r\nimport { id as moduleId } from \"../../../public/module.json\";\r\nimport { recordVibeCheckResponse } from \"./VibeCheckPopup\";\r\n\r\nexport function registerSocketEvents() {\r\n  game.socket.on(`module.${moduleId}`, handleSocketEvent);\r\n}\r\n\r\nexport async function emitSocketEvent({ type, payload }) {\r\n  let event = {\r\n    type,\r\n    payload,\r\n  };\r\n  await game.socket.emit(`module.${moduleId}`, event);\r\n  handleSocketEvent(event);\r\n}\r\n\r\nexport async function sendReactionToSocket(reactionId) {\r\n  emitSocketEvent({\r\n    type: \"icon\",\r\n    payload: reactionId,\r\n  });\r\n}\r\n\r\nexport async function reloadAllClients() {\r\n  emitSocketEvent({\r\n    type: \"reload\",\r\n    payload: \"\",\r\n  });\r\n}\r\n\r\nexport async function sendVibeCheckResponse(user, responseId) {\r\n  emitSocketEvent({\r\n    type: \"vibecheckresponse\",\r\n    payload: { user: user, response: responseId },\r\n  });\r\n}\r\n\r\nexport async function initiateVibeCheck() {\r\n  emitSocketEvent({\r\n    type: \"vibecheck\",\r\n    payload: { duration: game.settings.get(moduleId, \"vibecheckduration\") },\r\n  });\r\n}\r\n\r\nfunction handleSocketEvent({ type, payload }) {\r\n  switch (type) {\r\n    case \"icon\":\r\n      insertSentReaction(payload);\r\n      break;\r\n\r\n    case \"reload\":\r\n      debouncedReload();\r\n      break;\r\n\r\n    case \"vibecheck\":\r\n      displayVibeCheck(payload.duration);\r\n      break;\r\n\r\n    case \"vibecheckresponse\":\r\n      recordVibeCheckResponse(payload);\r\n      break;\r\n\r\n    default:\r\n      throw new Error(\"unknown type\");\r\n      break;\r\n  }\r\n}\r\n","import { gsap, CustomWiggle, CustomEase } from \"/scripts/greensock/esm/all.js\";\r\nimport { randomNumber, getReactionObject, getReactionHTML } from \"./utils\";\r\nimport { sendReactionToSocket } from \"./socket\";\r\nimport { id as moduleId } from \"../../../public/module.json\";\r\nimport VibeCheckPopup from \"./VibeCheckPopup\";\r\n\r\nexport async function insertSentReaction(reactionId) {\r\n  let reaction = await getReactionObject(reactionId);\r\n\r\n  let htmlString = await getReactionHTML(reaction);\r\n  let $fullScreen = $(\"#interface\");\r\n\r\n  let $added = $(htmlString).appendTo($fullScreen);\r\n  gsap.effects[reaction.effect]($added, {\r\n    parent: $fullScreen,\r\n    reaction: reaction,\r\n  });\r\n}\r\n\r\nexport async function displayVibeCheck(duration) {\r\n  let vc = VibeCheckPopup.getInstance();\r\n  vc.userResponses = [];\r\n  vc.render(true);\r\n  if (duration > 0) {\r\n    if (!game.user.isGM) {\r\n      setTimeout(() => vc.close(), duration * 1000);\r\n    } else {\r\n      setTimeout(() => vc.close(), duration * 2 * 1000);\r\n    }\r\n  }\r\n}\r\n\r\nexport async function handleReactionClick(id) {\r\n  // let clickedReaction = reactions.find(r => r.id == id)\r\n  sendReactionToSocket(id);\r\n}\r\n","export const reactionSets = {\r\n  default: {\r\n    label: \"Default\",\r\n    reactions: [\r\n      {\r\n        id: \"0\",\r\n        speed: \"1\",\r\n        enabled: \"true\",\r\n        title: \"Like\",\r\n        icon: \"heart\",\r\n        primaryColor: \"#eb34b1\",\r\n        secondaryColor: \"\",\r\n        style: \"fas\",\r\n        effect: \"physics-floatUp\",\r\n        directional: false,\r\n        type: \"fontawesome\",\r\n        path: \"\",\r\n        maxWidth: 200,\r\n        maxHeight: 200,\r\n        fontSize: 48,\r\n      },\r\n      {\r\n        id: \"1\",\r\n        speed: \"1\",\r\n        enabled: \"true\",\r\n        title: \"OMG\",\r\n        icon: \"triangle-exclamation\",\r\n        primaryColor: \"#c52525\",\r\n        secondaryColor: \"#efaa4b\",\r\n        style: \"fa-duotone\",\r\n        effect: \"physics-floatUp\",\r\n        directional: false,\r\n        type: \"fontawesome\",\r\n        path: \"\",\r\n        maxWidth: 200,\r\n        maxHeight: 200,\r\n        fontSize: 48,\r\n      },\r\n      {\r\n        id: \"2\",\r\n        speed: \"1\",\r\n        enabled: \"true\",\r\n        title: \"Axe\",\r\n        icon: \"axe\",\r\n        primaryColor: \"#5f7e96\",\r\n        secondaryColor: \"#c1c1c1\",\r\n        style: \"fa-duotone\",\r\n        effect: \"physics-toss\",\r\n        directional: true,\r\n        type: \"fontawesome\",\r\n        path: \"\",\r\n        maxWidth: 200,\r\n        maxHeight: 200,\r\n        fontSize: 48,\r\n      },\r\n      {\r\n        id: \"3\",\r\n        speed: \"1\",\r\n        enabled: \"true\",\r\n        title: \"droplet\",\r\n        icon: \"droplet\",\r\n        primaryColor: \"#a4fbf7\",\r\n        secondaryColor: \"#00a6ff\",\r\n        style: \"fa-duotone\",\r\n        effect: \"physics-drop\",\r\n        directional: false,\r\n        type: \"fontawesome\",\r\n        path: \"\",\r\n        maxWidth: 200,\r\n        maxHeight: 200,\r\n        fontSize: 48,\r\n      },\r\n      {\r\n        id: \"4\",\r\n        speed: \"1\",\r\n        enabled: \"true\",\r\n        title: \"fire\",\r\n        icon: \"fire\",\r\n        primaryColor: \"#dd0000\",\r\n        secondaryColor: \"#f5c767\",\r\n        style: \"fa-duotone\",\r\n        effect: \"physics-floatUp\",\r\n        directional: false,\r\n        type: \"fontawesome\",\r\n        path: \"\",\r\n        maxWidth: 200,\r\n        maxHeight: 200,\r\n        fontSize: 48,\r\n      },\r\n      {\r\n        id: \"5\",\r\n        speed: \"1\",\r\n        enabled: \"true\",\r\n        title: \"x\",\r\n        icon: \"times\",\r\n        primaryColor: \"#dd0000\",\r\n        secondaryColor: \"rgba(255,255,255,0.6)\",\r\n        style: \"fas\",\r\n        effect: \"shutdown\",\r\n        directional: false,\r\n        type: \"fontawesome\",\r\n        path: \"\",\r\n        maxWidth: 200,\r\n        maxHeight: 200,\r\n        fontSize: 48,\r\n      },\r\n    ],\r\n  },\r\n  sciFantasy: {\r\n    label: \"Sci-Fantasy\",\r\n    reactions: [\r\n      {\r\n        id: \"0\",\r\n        speed: \"1\",\r\n        enabled: \"true\",\r\n        title: \"Like\",\r\n        icon: \"heart\",\r\n        primaryColor: \"#eb34b1\",\r\n        secondaryColor: \"\",\r\n        style: \"fas\",\r\n        effect: \"physics-floatUp\",\r\n        directional: false,\r\n        type: \"fontawesome\",\r\n        path: \"\",\r\n        maxWidth: 200,\r\n        maxHeight: 200,\r\n        fontSize: 48,\r\n      },\r\n      {\r\n        id: \"1\",\r\n        speed: \"1\",\r\n        enabled: \"true\",\r\n        title: \"Warning\",\r\n        icon: \"siren\",\r\n        primaryColor: \"#5b7b8e\",\r\n        secondaryColor: \"#e60404\",\r\n        style: \"fa-duotone\",\r\n        effect: \"physics-floatUp\",\r\n        directional: false,\r\n        type: \"fontawesome\",\r\n        path: \"\",\r\n        maxWidth: 200,\r\n        maxHeight: 200,\r\n        fontSize: 48,\r\n      },\r\n      {\r\n        id: \"2\",\r\n        speed: \"1\",\r\n        enabled: \"true\",\r\n        title: \"Laser Sword\",\r\n        icon: \"sword-laser\",\r\n        primaryColor: \"#7a7a7a\",\r\n        secondaryColor: \"#51e367\",\r\n        style: \"fa-duotone\",\r\n        effect: \"physics-toss\",\r\n        directional: true,\r\n        type: \"fontawesome\",\r\n        path: \"\",\r\n        maxWidth: 200,\r\n        maxHeight: 200,\r\n        fontSize: 48,\r\n      },\r\n      {\r\n        id: \"3\",\r\n        speed: \"1\",\r\n        enabled: \"true\",\r\n        title: \"Space Station\",\r\n        icon: \"space-station-moon-construction\",\r\n        primaryColor: \"#cfcfcf\",\r\n        secondaryColor: \"#585858\",\r\n        style: \"fa-duotone\",\r\n        effect: \"physics-drop\",\r\n        directional: false,\r\n        type: \"fontawesome\",\r\n        path: \"\",\r\n        maxWidth: 200,\r\n        maxHeight: 200,\r\n        fontSize: 48,\r\n      },\r\n      {\r\n        id: \"4\",\r\n        speed: \"1\",\r\n        enabled: \"true\",\r\n        title: \"Ship\",\r\n        icon: \"starship-freighter\",\r\n        primaryColor: \"#5f6d7e\",\r\n        secondaryColor: \"#aeaeae\",\r\n        style: \"fa-duotone\",\r\n        effect: \"physics-toss\",\r\n        directional: false,\r\n        type: \"fontawesome\",\r\n        path: \"\",\r\n        maxWidth: 200,\r\n        maxHeight: 200,\r\n        fontSize: 48,\r\n      },\r\n      {\r\n        id: \"5\",\r\n        speed: \"1\",\r\n        enabled: \"true\",\r\n        title: \"x\",\r\n        icon: \"square-xmark\",\r\n        primaryColor: \"#dd0000\",\r\n        secondaryColor: \"rgba(255,255,255,0.6)\",\r\n        style: \"fas\",\r\n        effect: \"shutdown\",\r\n        directional: false,\r\n        type: \"fontawesome\",\r\n        path: \"\",\r\n        maxWidth: 200,\r\n        maxHeight: 200,\r\n        fontSize: 48,\r\n      },\r\n    ],\r\n  },\r\n  cozy: {\r\n    label: \"Cozy\",\r\n    reactions: [\r\n      {\r\n        id: \"0\",\r\n        speed: \"1\",\r\n        enabled: \"true\",\r\n        title: \"Like\",\r\n        icon: \"leaf\",\r\n        primaryColor: \"#a8df35\",\r\n        secondaryColor: \"#6c9733\",\r\n        style: \"fa-duotone\",\r\n        effect: \"physics-flutterDown\",\r\n        directional: false,\r\n        type: \"fontawesome\",\r\n        path: \"\",\r\n        maxWidth: 200,\r\n        maxHeight: 200,\r\n        fontSize: 48,\r\n      },\r\n      {\r\n        id: \"1\",\r\n        speed: \"1\",\r\n        enabled: \"true\",\r\n        title: \"OMG\",\r\n        icon: \"triangle-exclamation\",\r\n        primaryColor: \"#f5ad42\",\r\n        secondaryColor: \"\",\r\n        style: \"fas\",\r\n        effect: \"physics-floatUp\",\r\n        directional: false,\r\n        type: \"fontawesome\",\r\n        path: \"\",\r\n        maxWidth: 200,\r\n        maxHeight: 200,\r\n        fontSize: 48,\r\n      },\r\n      {\r\n        id: \"2\",\r\n        speed: \"1\",\r\n        enabled: \"true\",\r\n        title: \"Axe\",\r\n        icon: \"mug-tea\",\r\n        primaryColor: \"#87b83d\",\r\n        secondaryColor: \"#ddbeaa\",\r\n        style: \"fa-duotone\",\r\n        effect: \"physics-floatUp\",\r\n        directional: true,\r\n        type: \"fontawesome\",\r\n        path: \"\",\r\n        maxWidth: 200,\r\n        maxHeight: 200,\r\n        fontSize: 48,\r\n      },\r\n      {\r\n        id: \"3\",\r\n        speed: \"1\",\r\n        enabled: \"true\",\r\n        title: \"droplet\",\r\n        icon: \"droplet\",\r\n        primaryColor: \"#a4fbf7\",\r\n        secondaryColor: \"#6bc7fe\",\r\n        style: \"fa-duotone\",\r\n        effect: \"physics-drop\",\r\n        directional: false,\r\n        type: \"fontawesome\",\r\n        path: \"\",\r\n        maxWidth: 200,\r\n        maxHeight: 200,\r\n        fontSize: 48,\r\n      },\r\n      {\r\n        id: \"4\",\r\n        speed: \"1\",\r\n        enabled: \"true\",\r\n        title: \"fire\",\r\n        icon: \"candle-holder\",\r\n        primaryColor: \"#f5efc5\",\r\n        secondaryColor: \"#eb8c34\",\r\n        style: \"fa-duotone\",\r\n        effect: \"physics-floatUp\",\r\n        directional: false,\r\n        type: \"fontawesome\",\r\n        path: \"\",\r\n        maxWidth: 200,\r\n        maxHeight: 200,\r\n        fontSize: 48,\r\n      },\r\n      {\r\n        id: \"5\",\r\n        speed: \"1\",\r\n        enabled: \"true\",\r\n        title: \"x\",\r\n        icon: \"times\",\r\n        primaryColor: \"#dd0000\",\r\n        secondaryColor: \"rgba(255,255,255,0.6)\",\r\n        style: \"fas\",\r\n        effect: \"shutdown\",\r\n        directional: false,\r\n        type: \"fontawesome\",\r\n        path: \"\",\r\n        maxWidth: 200,\r\n        maxHeight: 200,\r\n        fontSize: 48,\r\n      },\r\n    ],\r\n  },\r\n  tavern: {\r\n    label: \"Tavern\",\r\n    reactions: [\r\n      {\r\n        id: \"0\",\r\n        speed: \"1\",\r\n        enabled: \"true\",\r\n        title: \"Like\",\r\n        icon: \"heart\",\r\n        primaryColor: \"#eb34b1\",\r\n        secondaryColor: \"\",\r\n        style: \"fas\",\r\n        effect: \"physics-floatUp\",\r\n        directional: false,\r\n        type: \"fontawesome\",\r\n        path: \"\",\r\n        maxWidth: 200,\r\n        maxHeight: 200,\r\n        fontSize: 48,\r\n      },\r\n      {\r\n        id: \"1\",\r\n        speed: \"1\",\r\n        enabled: \"true\",\r\n        title: \"OMG\",\r\n        icon: \"triangle-exclamation\",\r\n        primaryColor: \"#c52525\",\r\n        secondaryColor: \"#efaa4b\",\r\n        style: \"fa-duotone\",\r\n        effect: \"physics-floatUp\",\r\n        directional: false,\r\n        type: \"fontawesome\",\r\n        path: \"\",\r\n        maxWidth: 200,\r\n        maxHeight: 200,\r\n        fontSize: 48,\r\n      },\r\n      {\r\n        id: \"2\",\r\n        speed: \"1\",\r\n        enabled: \"true\",\r\n        title: \"Axe\",\r\n        icon: \"axe\",\r\n        primaryColor: \"#5f7e96\",\r\n        secondaryColor: \"#c1c1c1\",\r\n        style: \"fa-duotone\",\r\n        effect: \"physics-toss\",\r\n        directional: true,\r\n        type: \"fontawesome\",\r\n        path: \"\",\r\n        maxWidth: 200,\r\n        maxHeight: 200,\r\n        fontSize: 48,\r\n      },\r\n      {\r\n        id: \"3\",\r\n        speed: \"1\",\r\n        enabled: \"true\",\r\n        title: \"Beer\",\r\n        icon: \"beer-mug\",\r\n        primaryColor: \"#fee2a0\",\r\n        secondaryColor: \"#69432c\",\r\n        style: \"fa-duotone\",\r\n        effect: \"physics-toss\",\r\n        directional: false,\r\n        type: \"fontawesome\",\r\n        path: \"\",\r\n        maxWidth: 200,\r\n        maxHeight: 200,\r\n        fontSize: 48,\r\n      },\r\n      {\r\n        id: \"4\",\r\n        speed: \"1\",\r\n        enabled: \"true\",\r\n        title: \"Meat\",\r\n        icon: \"meat\",\r\n        primaryColor: \"#ae4020\",\r\n        secondaryColor: \"#fbe7bd\",\r\n        style: \"fa-duotone\",\r\n        effect: \"physics-floatUp\",\r\n        directional: false,\r\n        type: \"fontawesome\",\r\n        path: \"\",\r\n        maxWidth: 200,\r\n        maxHeight: 200,\r\n        fontSize: 48,\r\n      },\r\n      {\r\n        id: \"5\",\r\n        speed: \"1\",\r\n        enabled: \"true\",\r\n        title: \"x\",\r\n        icon: \"times\",\r\n        primaryColor: \"#dd0000\",\r\n        secondaryColor: \"rgba(255,255,255,0.6)\",\r\n        style: \"fas\",\r\n        effect: \"shutdown\",\r\n        directional: false,\r\n        type: \"fontawesome\",\r\n        path: \"\",\r\n        maxWidth: 200,\r\n        maxHeight: 200,\r\n        fontSize: 48,\r\n      },\r\n    ],\r\n  },\r\n};\r\n","import { ReactionSetupMenu } from \"./ReactionSetupMenu\";\r\nimport { id as moduleId } from \"../../../public/module.json\";\r\nimport { saveAllReactionPNGs } from \"./utils\";\r\nimport { reactionSets } from \"./reactionsets\";\r\n\r\nexport const ReactionOption = {\r\n  id: 0,\r\n  title: \"\",\r\n  icon: \"\",\r\n  primaryColor: \"\",\r\n  secondaryColor: \"\",\r\n  style: \"\",\r\n  speed: 0,\r\n  effect: \"\",\r\n  directional: false,\r\n  enabled: true,\r\n  type: \"\",\r\n  path: \"\",\r\n  maxWidth: 200,\r\n  maxHeight: 200,\r\n};\r\n\r\nexport const typeOptions = [\r\n  {\r\n    label: \"Image/Video\",\r\n    value: \"filepicker\",\r\n  },\r\n  {\r\n    label: \"Font Icon\",\r\n    value: \"fontawesome\",\r\n  },\r\n];\r\n\r\nexport type ReactionOption = typeof ReactionOption;\r\n\r\nexport async function loadReactionsPreset(presetName: string) {\r\n  let reactions = reactionSets[presetName].reactions;\r\n  await game.settings.set(moduleId, \"reactions\", reactions);\r\n  //   await saveAllReactionPNGs(true);\r\n  //   debouncedReload();\r\n  return;\r\n}\r\n\r\nexport function registerSettings() {\r\n  console.log(\"Registering CGW Settings\");\r\n  game.settings.register(moduleId, \"reactions\", {\r\n    name: \"Reaction\",\r\n    hint: \"The list of reactions usable by your players\",\r\n    scope: \"world\", // \"world\" = sync to db, \"client\" = local storage\r\n    config: false, // false if you dont want it to show in module config\r\n    type: Array, // Number, Boolean, String, Object\r\n    default: reactionSets[\"default\"].reactions,\r\n    onChange: (value) => {\r\n      // value is the new value of the setting\r\n    },\r\n  });\r\n\r\n  game.settings.register(moduleId, \"vibecheckautoclose\", {\r\n    name: \"Close vibe check after selection\",\r\n    hint: \"If this is enabled, players' vibe check popups will close after they make a selection. If this is disabled, it will stay open and they can choose another reaction.\",\r\n    scope: \"world\", // \"world\" = sync to db, \"client\" = local storage\r\n    config: true, // false if you dont want it to show in module config\r\n    type: Boolean, // Number, Boolean, String, Object\r\n    default: true,\r\n    onChange: (value) => {\r\n      // value is the new value of the setting\r\n    },\r\n  });\r\n\r\n  game.settings.register(moduleId, \"vibecheckduration\", {\r\n    name: \"Vibe check duration\",\r\n    hint: \"This determines, in seconds, how long players have to respond to a vibe check. The results will display to the GM for twice this duration. 0 = no timeout\",\r\n    scope: \"world\", // \"world\" = sync to db, \"client\" = local storage\r\n    config: true, // false if you dont want it to show in module config\r\n    type: Number, // Number, Boolean, String, Object\r\n    default: 10,\r\n    range: {\r\n      min: 0,\r\n      step: 10,\r\n      max: 60,\r\n    },\r\n    onChange: (value) => {\r\n      // value is the new value of the setting\r\n    },\r\n  });\r\n\r\n  game.settings.register(moduleId, \"maxdisplayed\", {\r\n    name: \"Maximum Simultaneous Reactions\",\r\n    hint: `Turn this down if you're running into performance issues from players spamming reactions.`,\r\n    scope: \"client\",\r\n    config: false,\r\n    type: Number,\r\n    range: {\r\n      min: 10,\r\n      max: 200,\r\n      step: 5,\r\n    },\r\n    default: 200,\r\n  });\r\n\r\n  // game.settings.registerMenu(moduleId, \"reactionSetup\", {\r\n  //   name: \"Reactions\",\r\n  //   label: \"Configure Available Reactions\", // The text label used in the button\r\n  //   hint: \"Use this menu to create up to eight reactions for your players to use during play.\",\r\n  //   icon: \"fas fa-bars\", // A Font Awesome icon used in the submenu button\r\n  //   type: ReactionSetupMenu, // A FormApplication subclass\r\n  //   restricted: true, // Restrict this submenu to gamemaster only?\r\n  // });\r\n}\r\n","import { id as moduleId } from \"../../../public/module.json\";\r\n\r\nexport class ReactionEditor extends FormApplication {\r\n  reactionId: Number;\r\n  parent;\r\n  constructor(reactionId, parent?) {\r\n    super({});\r\n    this.reactionId = reactionId;\r\n    this.parent = parent;\r\n  }\r\n\r\n  loadedJSON = {};\r\n  selectedPreset = \"default\";\r\n\r\n  static get defaultOptions() {\r\n    return mergeObject(super.defaultOptions, {\r\n      classes: [\"form\", \"crowdgoeswild\", \"reactionEdtior\"],\r\n      popOut: true,\r\n      template: `modules/${moduleId}/templates/ReactionEditor.hbs`,\r\n      id: `${moduleId}-reaction-editor`,\r\n      title: \"CrowdGoesWild - Reaction Editor\",\r\n      width: 600,\r\n      height: \"auto\",\r\n      submitOnChange: true,\r\n      closeOnSubmit: false,\r\n      resizable: true,\r\n    });\r\n  }\r\n\r\n  async getData() {\r\n    let reactions = await game.settings.get(moduleId, \"reactions\");\r\n    let data = reactions.find((reaction) => reaction.id == this.reactionId);\r\n    return data;\r\n  }\r\n\r\n  async _updateObject(event, formData) {\r\n    const data = expandObject(formData);\r\n    let reactions = await game.settings.get(moduleId, \"reactions\");\r\n\r\n    let index = reactions.findIndex(\r\n      (reaction) => reaction.id == this.reactionId\r\n    );\r\n\r\n    reactions[index] = formData;\r\n\r\n    await game.settings.set(moduleId, \"reactions\", reactions);\r\n    await this.render();\r\n    await this.parent.render();\r\n  }\r\n\r\n  switchColors(inputEl1, inputEl2) {\r\n    let v1 = inputEl1.value;\r\n    let v2 = inputEl2.value;\r\n    console.log(inputEl1, inputEl2);\r\n\r\n    inputEl1.value = v2;\r\n    inputEl2.value = v1;\r\n  }\r\n\r\n  activateListeners(html) {\r\n    super.activateListeners(html);\r\n\r\n    // html.find(\"#generateButton\").on(\"click\", async (ev) => {\r\n    //   this.close();\r\n    //   await saveAllReactionPNGs(true);\r\n    //   reloadAllClients();\r\n    // });\r\n    // html.find(\"#resetButton\").on(\"click\", (ev) => {\r\n    //   this.showLoadPresetDialog();\r\n    // });\r\n    // html.find(\"#exportButton\").on(\"click\", (ev) => {\r\n    //   this.exportReactions();\r\n    // });\r\n    // html.find(\"#importButton\").on(\"click\", (ev) => {\r\n    //   this.showImportReactionsDialog();\r\n    // });\r\n    // html.find(\"#reactionPreset\").on(\"change\", (ev) => {\r\n    //   ev.stopPropagation();\r\n    //   this.selectedPreset = ev.currentTarget.value;\r\n    // });\r\n\r\n    html.find(\".colorSwitch\").on(\"click\", (ev) => {\r\n      ev.stopPropagation();\r\n      let i1 = $(ev.currentTarget)\r\n        .parents(\".colors\")\r\n        .find(\".primaryColor input.color\")\r\n        .first()\r\n        .get(0);\r\n      let i2 = $(ev.currentTarget)\r\n        .parents(\".colors\")\r\n        .find(\".secondaryColor input.color\")\r\n        .first()\r\n        .get(0);\r\n\r\n      console.log(i1, i2);\r\n      this.switchColors(i1, i2);\r\n    });\r\n\r\n    // html.find(\".pathPicker\").on(\"click\", (ev) => {\r\n    //   let inputEl = $(ev.currentTarget).siblings(\"input.path\").get(0);\r\n    //   inputEl.value = \"butts\";\r\n    //   let picker = new FilePicker({\r\n    //     callback: (picked) => {\r\n    //       console.log(picked);\r\n    //       try {\r\n    //         inputEl.value = picked;\r\n    //       } catch (error) {\r\n    //         console.error(error);\r\n    //       }\r\n    //     },\r\n    //   });\r\n    //   picker.render(true);\r\n    // });\r\n  }\r\n\r\n  // showImportReactionsDialog() {\r\n  //   let d = new Dialog({\r\n  //     title: \"Import Reactions\",\r\n  //     content: `\r\n  //           <p>Import a set of reactions from a JSON file? All current reactions will be overwritten.</p>\r\n  //           <input type=\"file\" id=\"importer\" name=\"reactionjson\" class=\"cgw importer\">\r\n  //           `,\r\n  //     buttons: {\r\n  //       one: {\r\n  //         icon: '<i class=\"fas fa-check\"></i>',\r\n  //         label: \"Import\",\r\n  //         callback: () => {\r\n  //           if (this.loadedJSON) {\r\n  //             this.saveReactionSetData(this.loadedJSON);\r\n  //           }\r\n  //         },\r\n  //       },\r\n  //       two: {\r\n  //         icon: '<i class=\"fas fa-times\"></i>',\r\n  //         label: \"Cancel\",\r\n  //         callback: () => {},\r\n  //       },\r\n  //     },\r\n  //     default: \"two\",\r\n  //     render: (html) => {\r\n  //       $(html)\r\n  //         .find(\"#importer\")\r\n  //         .on(\"change\", (ev) => {\r\n  //           console.log(\"Loaded file\");\r\n  //           let reader = new FileReader();\r\n  //           reader.onload = (readerEv) => {\r\n  //             try {\r\n  //               let loadedJSON = JSON.parse(readerEv.target.result);\r\n  //               if (this.validateLoadedJSON(loadedJSON)) {\r\n  //                 this.loadedJSON = loadedJSON;\r\n  //               }\r\n  //             } catch (error) {\r\n  //               console.log(\"Invalid JSON file\");\r\n  //               this.loadedJSON = false;\r\n  //             }\r\n  //           };\r\n  //           reader.readAsText(ev.target.files[0]);\r\n  //         });\r\n  //     },\r\n  //     close: (html) => {},\r\n  //   });\r\n  //   d.render(true);\r\n  // }\r\n\r\n  // async exportReactions() {\r\n  //   let data = await game.settings.get(moduleId, \"reactions\");\r\n  //   let dataJSON = JSON.stringify(data);\r\n  //   saveDataToFile(dataJSON, \"text/json\", \"reactions.json\");\r\n  // }\r\n\r\n  // async saveReactionSetData(data) {\r\n  // await game.settings.set(moduleId, 'reactions', data)\r\n  // }\r\n\r\n  // validateLoadedJSON(data) {\r\n  //   let isValid = true;\r\n  //   // make sure it's an array\r\n  //   if (Array.isArray(data)) {\r\n  //     // make sure nobody's slipping in the wrong number of reactions\r\n  //     if (data.length == 6) {\r\n  //       // check each row to make sure it has the right fields\r\n  //       for (const row of data) {\r\n  //         for (const key in ReactionOption) {\r\n  //           if (!(key in row)) {\r\n  //             isValid = false;\r\n  //             console.log(`Invalid JSON data in row ${row.id}: Missing ${key}`);\r\n  //           }\r\n  //         }\r\n  //       }\r\n  //     } else {\r\n  //       isValid = false;\r\n  //     }\r\n  //   }\r\n  //   return isValid;\r\n  // }\r\n\r\n  // showLoadPresetDialog() {\r\n  //   let d = new Dialog({\r\n  //     title: \"Load Preset\",\r\n  //     content: `<p>Load the ${\r\n  //       reactionSets[this.selectedPreset].label\r\n  //     } preset? Any changes you've made to reactions will be lost.</p>`,\r\n  //     buttons: {\r\n  //       one: {\r\n  //         icon: '<i class=\"fas fa-check\"></i>',\r\n  //         label: \"Load Preset\",\r\n  //         callback: async () => {\r\n  //           await loadReactionsPreset(this.selectedPreset);\r\n  //           this.render(false);\r\n  //         },\r\n  //       },\r\n  //       two: {\r\n  //         icon: '<i class=\"fas fa-times\"></i>',\r\n  //         label: \"Cancel\",\r\n  //         callback: () => {},\r\n  //       },\r\n  //     },\r\n  //     default: \"two\",\r\n  //     render: (html) => {},\r\n  //     close: (html) => {},\r\n  //   });\r\n  //   d.render(true);\r\n  // }\r\n}\r\n","import { id as moduleId } from \"../../../public/module.json\";\r\nimport { calcAngleDegrees, saveAllReactionPNGs } from \"./utils\";\r\nimport { loadReactionsPreset, ReactionOption } from \"./settings\";\r\nimport { reactionSets } from \"./reactionsets\";\r\nimport { reloadAllClients } from \"./socket\";\r\nimport { ReactionEditor } from \"./ReactionEditor\";\r\n\r\nexport class ReactionSetupMenu extends Application {\r\n  // constructor(exampleOption) {\r\n  //     super(exampleOption);\r\n  // }\r\n\r\n  loadedJSON = {};\r\n  selectedPreset = \"default\";\r\n\r\n  static get defaultOptions() {\r\n    return mergeObject(super.defaultOptions, {\r\n      classes: [\"form\", \"crowdgoeswild\", \"reactionSetup\"],\r\n      popOut: true,\r\n      template: `modules/${moduleId}/templates/ReactionSetup.hbs`,\r\n      id: `${moduleId}-reaction-setup`,\r\n      title: \"CrowdGoesWild - Reaction Setup\",\r\n      width: 1200,\r\n      // submitOnChange: true,\r\n      closeOnSubmit: false,\r\n      resizable: true,\r\n    });\r\n  }\r\n\r\n  async getData() {\r\n    let data = {\r\n      currentReactions: [],\r\n      presets: reactionSets,\r\n      selectedPreset: this.selectedPreset,\r\n    };\r\n    data.currentReactions = game.settings.get(moduleId, \"reactions\") as [];\r\n    // let outputReactions = []\r\n    // for (const reaction of currentReactions) {\r\n    //     if(!reaction.id){\r\n\r\n    //     }\r\n    // }\r\n    return data;\r\n  }\r\n\r\n  // switchColors(inputEl1, inputEl2) {\r\n  //   let v1 = inputEl1.value;\r\n  //   let v2 = inputEl2.value;\r\n  //   console.log(inputEl1, inputEl2);\r\n\r\n  //   inputEl1.value = v2;\r\n  //   inputEl2.value = v1;\r\n  // }\r\n\r\n  // async _updateObject(event, formData) {\r\n  //   const data = expandObject(formData);\r\n  //   let reactions = [];\r\n\r\n  //   for (const reaction of Object.values(data)) {\r\n  //     reactions[reaction.id] = reaction;\r\n  //   }\r\n  //   await game.settings.set(moduleId, \"reactions\", reactions);\r\n  //   await this.render();\r\n  // }\r\n\r\n  activateListeners(html) {\r\n    //   super.activateListeners(html);\r\n\r\n    //   html.find(\"#generateButton\").on(\"click\", async (ev) => {\r\n    //     this.close();\r\n    //     await saveAllReactionPNGs(true);\r\n    //     reloadAllClients();\r\n    //   });\r\n    html.find(\"#resetButton\").on(\"click\", (ev) => {\r\n      ev.stopPropagation();\r\n      this.showLoadPresetDialog();\r\n    });\r\n\r\n    html.find(\".reactionEdit\").on(\"click\", (ev) => {\r\n      ev.stopPropagation();\r\n      let reactionEditor = new ReactionEditor(\r\n        ev.currentTarget.dataset.id,\r\n        this\r\n      );\r\n      reactionEditor.render(true);\r\n    });\r\n    //   html.find(\"#exportButton\").on(\"click\", (ev) => {\r\n    //     this.exportReactions();\r\n    //   });\r\n    //   html.find(\"#importButton\").on(\"click\", (ev) => {\r\n    //     this.showImportReactionsDialog();\r\n    //   });\r\n    html.find(\"#reactionPreset\").on(\"change\", (ev) => {\r\n      ev.stopPropagation();\r\n      this.selectedPreset = ev.currentTarget.value;\r\n    });\r\n\r\n    //   html.find(\".colorSwitch\").on(\"click\", (ev) => {\r\n    //     ev.stopPropagation();\r\n    //     let i1 = $(ev.target)\r\n    //       .parents(\".reactionRow\")\r\n    //       .find(\".primaryColor input.color\")\r\n    //       .first()\r\n    //       .get(0);\r\n    //     let i2 = $(ev.target)\r\n    //       .parents(\".reactionRow\")\r\n    //       .find(\".secondaryColor input.color\")\r\n    //       .first()\r\n    //       .get(0);\r\n    //     this.switchColors(i1, i2);\r\n    //   });\r\n\r\n    // html.find(\".pathPicker\").on(\"click\", (ev) => {\r\n    //   let inputEl = $(ev.currentTarget).siblings(\"input.path\").get(0);\r\n    //   inputEl.value = \"butts\";\r\n    //   let picker = new FilePicker({\r\n    //     callback: (picked) => {\r\n    //       console.log(picked);\r\n    //       try {\r\n    //         inputEl.value = picked;\r\n    //       } catch (error) {\r\n    //         console.error(error);\r\n    //       }\r\n    //     },\r\n    //   });\r\n    //   picker.render(true);\r\n    // });\r\n  }\r\n\r\n  showImportReactionsDialog() {\r\n    let d = new Dialog({\r\n      title: \"Import Reactions\",\r\n      content: `\r\n            <p>Import a set of reactions from a JSON file? All current reactions will be overwritten.</p>\r\n            <input type=\"file\" id=\"importer\" name=\"reactionjson\" class=\"cgw importer\">\r\n            `,\r\n      buttons: {\r\n        one: {\r\n          icon: '<i class=\"fas fa-check\"></i>',\r\n          label: \"Import\",\r\n          callback: () => {\r\n            if (this.loadedJSON) {\r\n              this.saveReactionSetData(this.loadedJSON);\r\n            }\r\n          },\r\n        },\r\n        two: {\r\n          icon: '<i class=\"fas fa-times\"></i>',\r\n          label: \"Cancel\",\r\n          callback: () => {},\r\n        },\r\n      },\r\n      default: \"two\",\r\n      render: (html) => {\r\n        $(html)\r\n          .find(\"#importer\")\r\n          .on(\"change\", (ev) => {\r\n            console.log(\"Loaded file\");\r\n            let reader = new FileReader();\r\n            reader.onload = (readerEv) => {\r\n              try {\r\n                let loadedJSON = JSON.parse(readerEv.target.result);\r\n                if (this.validateLoadedJSON(loadedJSON)) {\r\n                  this.loadedJSON = loadedJSON;\r\n                }\r\n              } catch (error) {\r\n                console.log(\"Invalid JSON file\");\r\n                this.loadedJSON = false;\r\n              }\r\n            };\r\n            reader.readAsText(ev.target.files[0]);\r\n          });\r\n      },\r\n      close: (html) => {},\r\n    });\r\n    d.render(true);\r\n  }\r\n\r\n  async exportReactions() {\r\n    let data = await game.settings.get(moduleId, \"reactions\");\r\n    let dataJSON = JSON.stringify(data);\r\n    saveDataToFile(dataJSON, \"text/json\", \"reactions.json\");\r\n  }\r\n\r\n  async saveReactionSetData(data) {\r\n    // await game.settings.set(moduleId, 'reactions', data)\r\n  }\r\n\r\n  validateLoadedJSON(data) {\r\n    let isValid = true;\r\n    // make sure it's an array\r\n    if (Array.isArray(data)) {\r\n      // make sure nobody's slipping in the wrong number of reactions\r\n      if (data.length == 6) {\r\n        // check each row to make sure it has the right fields\r\n        for (const row of data) {\r\n          for (const key in ReactionOption) {\r\n            if (!(key in row)) {\r\n              isValid = false;\r\n              console.log(`Invalid JSON data in row ${row.id}: Missing ${key}`);\r\n            }\r\n          }\r\n        }\r\n      } else {\r\n        isValid = false;\r\n      }\r\n    }\r\n    return isValid;\r\n  }\r\n\r\n  showLoadPresetDialog() {\r\n    let d = new Dialog({\r\n      title: \"Load Preset\",\r\n      content: `<p>Load the ${\r\n        reactionSets[this.selectedPreset].label\r\n      } preset? Any changes you've made to reactions will be lost.</p>`,\r\n      buttons: {\r\n        one: {\r\n          icon: '<i class=\"fas fa-check\"></i>',\r\n          label: \"Load Preset\",\r\n          callback: async () => {\r\n            await loadReactionsPreset(this.selectedPreset);\r\n            this.render(false);\r\n          },\r\n        },\r\n        two: {\r\n          icon: '<i class=\"fas fa-times\"></i>',\r\n          label: \"Cancel\",\r\n          callback: () => {},\r\n        },\r\n      },\r\n      default: \"two\",\r\n      render: (html) => {},\r\n      close: (html) => {},\r\n    });\r\n    d.render(true);\r\n  }\r\n}\r\n","import { id as moduleId } from \"../../../public/module.json\";\r\nimport * as htmlToImage from \"html-to-image\";\r\nimport { toPng, toJpeg, toBlob, toPixelData, toSvg } from \"html-to-image\";\r\nimport { handleReactionClick } from \"./events\";\r\nimport { initiateVibeCheck } from \"./socket\";\r\nimport { ReactionSetupMenu } from \"./ReactionSetupMenu\";\r\n\r\nexport function randomNumber(min, max) {\r\n  return Math.random() * (max - min) + min;\r\n}\r\n\r\nexport function invlerp(x, y, a) {\r\n  return clamp((a - x) / (y - x));\r\n}\r\n\r\nexport function lerp(start, end, amt) {\r\n  return (1 - amt) * start + amt * end;\r\n}\r\n\r\nexport function clamp(a, min = 0, max = 1) {\r\n  return Math.min(max, Math.max(min, a));\r\n}\r\n\r\nexport function calcAngleDegrees(x, y) {\r\n  return (Math.atan2(y, x) * 180) / Math.PI;\r\n}\r\n\r\nexport async function getReactionAsImage(reactionObject) {\r\n  let reactionHTML = await getReactionHTML(reactionObject);\r\n  let $interface = $(\"#interface\");\r\n  // let interfaceEl = $interface.get(0)\r\n  // let $addedChild = $('<div id=\"interfaceShadow\"></div>')\r\n  // let addedChildEl = $addedChild.get(0)\r\n\r\n  // let shadow = addedChildEl.attachShadow({mode: 'open'})\r\n  let $appended = $(reactionHTML).appendTo($interface);\r\n  $appended.css({ zIndex: \"-10000\" });\r\n\r\n  // $(shadow).append(reactionHTML)\r\n  // let shadowEl = addedChildEl.shadowRoot\r\n  let iconPNGData;\r\n  try {\r\n    iconPNGData = await htmlToImage.toPng($appended.get(0));\r\n  } catch (error) {\r\n    console.error(\"oops, something went wrong!\", error);\r\n  }\r\n\r\n  $appended.remove();\r\n  return iconPNGData;\r\n}\r\n\r\nexport async function getReactionObject(reactionId) {\r\n  let reactions = (await game.settings.get(moduleId, \"reactions\")) as [];\r\n  let reaction = reactions.find((r) => r.id == reactionId);\r\n  return reaction;\r\n}\r\n\r\nexport function getReactionHTML(reaction) {\r\n  let htmlString = \"\";\r\n  if (reaction.type == \"fontawesome\") {\r\n    htmlString = `\r\n          <i class=\"${reaction.style} fa-${reaction.icon} cgw-reaction\" \r\n              data-id=${reaction.id}\r\n              style=\"\r\n                  color: ${reaction.primaryColor}; \r\n                  --fa-primary-color: ${reaction.primaryColor};\r\n                  --fa-secondary-color: ${reaction.secondaryColor};\r\n                  font-size: ${reaction.fontSize}px;\r\n              \">\r\n          </i>`;\r\n  } else if (\r\n    reaction.type == \"filepicker\" &&\r\n    [\"png\", \"jpg\", \"jpeg\", \"webp\", \"avif\", \"svg\", \".gif\"].includes(\r\n      reaction.path?.split(\".\").pop()\r\n    )\r\n  ) {\r\n    htmlString = `\r\n          <img\r\n            class=\"cgw-reaction\" \r\n            data-id=${reaction.id}\r\n            src=\"${reaction.path}\"\r\n            style=\"\r\n              max-width: ${reaction.maxWidth}px;\r\n              max-height: ${reaction.maxHeight}px;\r\n            \"\r\n          />`;\r\n  } else if (\r\n    reaction.type == \"filepicker\" &&\r\n    [\"webm\", \"mp4\", \"m4v\"].includes(reaction.path?.split(\".\").pop())\r\n  ) {\r\n    htmlString = `\r\n          <video class=\"cgw-reaction\" data-id=${reaction.id} autoplay loop muted\r\n            style=\"\r\n              max-width: ${reaction.maxWidth}px;\r\n              max-height: ${reaction.maxHeight}px;\r\n            \"\r\n          >\r\n            <source src=\"${reaction.path}\" \r\n            type=\"video/${reaction.path?.split(\".\").pop()}\"\r\n            />\r\n          </video>\r\n          `;\r\n  }\r\n  return htmlString;\r\n}\r\n\r\nexport async function saveAllReactionPNGs(force = false) {\r\n  if (force) {\r\n    ui.notifications.info(\r\n      `Generating icons for reaction macros. This will take a moment.`,\r\n      { permanent: false }\r\n    );\r\n  }\r\n  let reactions = (await game.settings.get(moduleId, \"reactions\")) as [];\r\n  for (const reaction of reactions) {\r\n    await generateReactionPNG(reaction, force);\r\n  }\r\n}\r\n\r\nexport async function generateReactionPNG(reactionObject, force) {\r\n  let worldPath = `worlds/${game.world.id}`;\r\n  let iconsPath = `worlds/${game.world.id}/reactionIcons`;\r\n  let world_dirs_list = await FilePicker.browse(\"data\", worldPath).then(\r\n    (picker) => picker.dirs\r\n  );\r\n  if (!world_dirs_list.includes(iconsPath)) {\r\n    console.log(\"Reactions icon folder doesn't exist. Creating it.\");\r\n    await FilePicker.createDirectory(\"data\", iconsPath);\r\n  }\r\n  // let macros_dirs_list = await FilePicker.browse(\"data\", macrosPath).then(picker => picker.dirs)\r\n  // if (!macros_dirs_list.includes(macrosPath + \"/reactions\")){\r\n  //     console.log(\"Reactions macro folder doesn't exist. Creating it.\");\r\n  //     await FilePicker.createDirectory('data', macrosPath + '/reactions')\r\n  // }\r\n\r\n  let imagesPath = iconsPath;\r\n  let files_list = await FilePicker.browse(\"data\", iconsPath).then(\r\n    (picker) => picker.files\r\n  );\r\n  if (\r\n    !files_list.includes(iconsPath + `/reaction-${reactionObject.id}.png`) ||\r\n    force\r\n  ) {\r\n    console.log(\"Image does not yet exist or force flag was set. Generating.\");\r\n    let imageDataURL = await getReactionAsImage(reactionObject);\r\n    let uploadResponse = await ImageHelper.uploadBase64(\r\n      imageDataURL,\r\n      `reaction-${reactionObject.id}.png`,\r\n      imagesPath\r\n    );\r\n    return uploadResponse.path;\r\n  } else {\r\n    console.log(\"Image already exists. Refusing to regenerate.\");\r\n    return;\r\n  }\r\n\r\n  // try {\r\n  // } catch (error) {\r\n  //     console.log(\"Folder exists. Using it!\")\r\n  // }\r\n  // folderPath += \"/reactions\"\r\n}\r\n\r\nexport async function getReactionPNGUrl(reactionId) {\r\n  return `worlds/${game.world.id}/reactionIcons/reaction-${reactionId}.png`;\r\n}\r\n\r\nexport async function renderChatButtonBar() {\r\n  let $chatForm = $(\"#chat-form\");\r\n  let $cgwContainer = $(\".cgwcontainer\");\r\n  $cgwContainer.remove();\r\n  let templatePath = `modules/${moduleId}/templates/parts/ReactionButtonBar.hbs`;\r\n  let templateData = {\r\n    reactions: (await game.settings.get(moduleId, \"reactions\")) as [],\r\n    isGM: game.user.isGM,\r\n  };\r\n\r\n  renderTemplate(templatePath, templateData)\r\n    .then((c) => {\r\n      if (c.length > 0) {\r\n        let $content = $(c);\r\n        $chatForm.after($content);\r\n\r\n        $content.find(\".reactionbar button\").on(\"click\", (event) => {\r\n          event.preventDefault();\r\n          let $self = $(event.currentTarget);\r\n          let dataset = event.currentTarget.dataset;\r\n          let id = dataset.id;\r\n          handleReactionClick(id);\r\n        });\r\n\r\n        $content.find(\".reactionbar button\").on(\"dragstart\", (event) => {\r\n          event.originalEvent.dataTransfer.setData(\r\n            \"text/plain\",\r\n            JSON.stringify({\r\n              id: event.currentTarget.dataset.id,\r\n              type: \"reaction\",\r\n            })\r\n          );\r\n        });\r\n\r\n        $content.find(\"button.vibecheck\").on(\"click\", (event) => {\r\n          initiateVibeCheck();\r\n        });\r\n\r\n        $content.find(\"button.cgwSettings\").on(\"click\", (event) => {\r\n          let reactionSetup = new ReactionSetupMenu();\r\n          reactionSetup.render(true);\r\n        });\r\n      }\r\n    })\r\n    .catch((e) => console.error(e));\r\n}\r\n// export const debouncedReload = foundry.utils.debounce(() => window.location.reload(), 500);\r\n","import {\r\n  gsap,\r\n  CustomWiggle,\r\n  CustomEase,\r\n  Physics2DPlugin,\r\n  Elastic,\r\n} from \"/scripts/greensock/esm/all.js\";\r\nimport { randomNumber, calcAngleDegrees, invlerp, lerp } from \"./utils\";\r\n\r\nexport function animationInit() {\r\n  gsap.registerPlugin(CustomEase, CustomWiggle, Physics2DPlugin);\r\n  CustomWiggle.create(\"wiggle\", {\r\n    wiggles: 5,\r\n    type: \"uniform\",\r\n    duration: 10,\r\n  });\r\n\r\n  CustomWiggle.create(\"shake\", {\r\n    wiggles: 8,\r\n    type: \"easeOut\",\r\n    duration: 1,\r\n  });\r\n\r\n  CustomWiggle.create(\"flutter\", {\r\n    wiggles: 6,\r\n    type: \"uniform\",\r\n    duration: 30,\r\n  });\r\n\r\n  registerEffects();\r\n}\r\n\r\nfunction registerEffects() {\r\n  let defaults = {\r\n    edgePaddingPercentage: 20,\r\n    offscreen: -50,\r\n  };\r\n\r\n  gsap.registerEffect({\r\n    name: \"fadeAndRemove\",\r\n    effect: (targets, config) => {\r\n      let tl = gsap.timeline();\r\n      tl.to(targets, {\r\n        duration: config.duration,\r\n        opacity: 0,\r\n      }).call(() => {\r\n        $(targets).remove();\r\n      });\r\n      return tl;\r\n    },\r\n    defaults: { duration: 2 },\r\n    extendTimeline: true,\r\n  });\r\n\r\n  gsap.registerEffect({\r\n    name: \"physics-floatUp\",\r\n    effect: (targets, config) => {\r\n      let tl = gsap.timeline({\r\n        defaults: {\r\n          duration: 5,\r\n        },\r\n      });\r\n\r\n      let $fullScreen = config.parent;\r\n\r\n      let edgePaddingPixels =\r\n        $fullScreen.width() * (defaults.edgePaddingPercentage / 100);\r\n      let xStart = edgePaddingPixels;\r\n      let xEnd = $fullScreen.width() - edgePaddingPixels;\r\n      let xFrom = randomNumber(xStart, xEnd);\r\n\r\n      let yEnd = $fullScreen.height();\r\n\r\n      gsap.set(targets, {\r\n        left: xFrom,\r\n        bottom: defaults.offscreen,\r\n      });\r\n\r\n      let randomLife = randomNumber(1, 5);\r\n\r\n      tl.to(\r\n        targets,\r\n        {\r\n          x: randomNumber(-40, 40),\r\n          scale: randomNumber(0.95, 1.25),\r\n          rotation: randomNumber(-10, 10),\r\n          duration: 10,\r\n          ease: \"wiggle\",\r\n        },\r\n        0\r\n      );\r\n      tl.to(\r\n        targets,\r\n        {\r\n          duration: 30,\r\n          physics2D: {\r\n            velocity: 200,\r\n            angle: \"random(250, 290)\",\r\n            // angle: ,\r\n            gravity: -100,\r\n          },\r\n        },\r\n        0\r\n      ).fadeAndRemove(targets, {}, randomLife);\r\n      return tl;\r\n    },\r\n  });\r\n\r\n  gsap.registerEffect({\r\n    name: \"floatUp\",\r\n    effect: (targets, config) => {\r\n      let tl = gsap.timeline({\r\n        defaults: {\r\n          duration: 5,\r\n        },\r\n      });\r\n\r\n      let $fullScreen = config.parent;\r\n\r\n      let edgePaddingPixels =\r\n        $fullScreen.width() * (defaults.edgePaddingPercentage / 100);\r\n      let xStart = edgePaddingPixels;\r\n      let xEnd = $fullScreen.width() - edgePaddingPixels;\r\n      let xFrom = randomNumber(xStart, xEnd);\r\n\r\n      let yEnd = $fullScreen.height();\r\n\r\n      gsap.set(targets, {\r\n        left: xFrom,\r\n        bottom: defaults.offscreen,\r\n      });\r\n\r\n      let randomLife = randomNumber(1, 5);\r\n\r\n      tl.to(\r\n        targets,\r\n        {\r\n          x: randomNumber(-40, 40),\r\n          scale: randomNumber(0.95, 1.25),\r\n          rotation: randomNumber(-10, 10),\r\n          duration: 10,\r\n          ease: \"wiggle\",\r\n        },\r\n        0\r\n      )\r\n        .to(\r\n          targets,\r\n          {\r\n            y: yEnd * -1,\r\n            ease: \"easeOut\",\r\n            duration: 8,\r\n          },\r\n          0\r\n        )\r\n        .fadeAndRemove(targets, {}, randomLife);\r\n      return tl;\r\n    },\r\n  });\r\n\r\n  gsap.registerEffect({\r\n    name: \"drop\",\r\n    effect: (targets, config) => {\r\n      let tl = gsap.timeline({\r\n        defaults: {\r\n          duration: 5,\r\n        },\r\n      });\r\n\r\n      let $fullScreen = config.parent;\r\n\r\n      let edgePaddingPixels =\r\n        $fullScreen.width() * (defaults.edgePaddingPercentage / 100);\r\n      let xStart = edgePaddingPixels;\r\n      let xEnd = $fullScreen.width() - edgePaddingPixels;\r\n      let xFrom = randomNumber(xStart, xEnd);\r\n\r\n      gsap.set(targets, {\r\n        left: xFrom,\r\n        top: defaults.offscreen * -1,\r\n      });\r\n\r\n      tl.to(\r\n        targets,\r\n        {\r\n          top: $fullScreen.height() + defaults.offscreen * -1,\r\n          ease: \"none\",\r\n          duration: 1,\r\n        },\r\n        0\r\n      ).fadeAndRemove(targets);\r\n\r\n      return tl;\r\n    },\r\n  });\r\n\r\n  gsap.registerEffect({\r\n    name: \"physics-drop\",\r\n    effect: (targets, config) => {\r\n      let tl = gsap.timeline({\r\n        defaults: {\r\n          duration: 5,\r\n        },\r\n      });\r\n\r\n      let $fullScreen = config.parent;\r\n\r\n      let edgePaddingPixels =\r\n        $fullScreen.width() * (defaults.edgePaddingPercentage / 100);\r\n      let xStart = edgePaddingPixels;\r\n      let xEnd = $fullScreen.width() - edgePaddingPixels;\r\n      let xFrom = randomNumber(xStart, xEnd);\r\n\r\n      gsap.set(targets, {\r\n        left: xFrom,\r\n        top: defaults.offscreen,\r\n      });\r\n\r\n      tl.to(\r\n        targets,\r\n        {\r\n          duration: 30,\r\n          physics2D: {\r\n            velocity: 0,\r\n            // velocity: 600,\r\n            // angle: \"random(250, 290)\",\r\n            angle: 0,\r\n            gravity: 500,\r\n          },\r\n        },\r\n        0\r\n      ).fadeAndRemove(targets);\r\n\r\n      return tl;\r\n    },\r\n  });\r\n\r\n  gsap.registerEffect({\r\n    name: \"physics-flutterDown\",\r\n    effect: (targets, config) => {\r\n      let tl = gsap.timeline();\r\n\r\n      let $fullScreen = config.parent;\r\n\r\n      let edgePaddingPixels =\r\n        $fullScreen.width() * (defaults.edgePaddingPercentage / 100);\r\n      let xStart = edgePaddingPixels;\r\n      let xEnd = $fullScreen.width() - edgePaddingPixels;\r\n      let xFrom = randomNumber(xStart, xEnd);\r\n\r\n      //wtf\r\n      tl.fromTo(\r\n        targets,\r\n        {\r\n          left: xFrom,\r\n          // top: 300,\r\n          top: defaults.offscreen,\r\n          transformOrigin: \"0 -500px\",\r\n          rotation: \"random(0, 20)\",\r\n          scaleX: \"random([-1, 1])\",\r\n        },\r\n        {\r\n          rotation: \"random([-60, -30, 30, 60])\",\r\n          ease: \"flutter\",\r\n          duration: 30,\r\n        },\r\n        0\r\n      );\r\n\r\n      tl.to(\r\n        targets,\r\n        {\r\n          duration: 30,\r\n          top: $fullScreen.height() + 100,\r\n          // physics2D: {\r\n          //   velocity: 0,\r\n          //   angle: 0,\r\n          //   gravity: 50,\r\n          // },\r\n        },\r\n        0\r\n      ).fadeAndRemove(targets);\r\n    },\r\n  });\r\n  gsap.registerEffect({\r\n    name: \"physics-toss\",\r\n    effect: (targets, config) => {\r\n      let tl = gsap.timeline();\r\n\r\n      let $fullScreen = config.parent;\r\n\r\n      let edgePaddingPixels =\r\n        $fullScreen.width() * (defaults.edgePaddingPercentage / 100);\r\n      let xStart = edgePaddingPixels;\r\n      let xEnd = $fullScreen.width() - edgePaddingPixels;\r\n      let xFrom = randomNumber(xStart, xEnd);\r\n\r\n      let center = { x: $fullScreen.width() / 2, y: $fullScreen.height() / 2 };\r\n      let angleToCenter =\r\n        calcAngleDegrees(xFrom - center.x, $fullScreen.height()) + 180;\r\n      // let directionRatio = lerp(-1, 1, invlerp(180, 360, angleToCenter))\r\n      let directionRatio = gsap.utils.mapRange(180, 360, -1, 1, angleToCenter);\r\n      directionRatio = directionRatio > 0 ? 1 : -1;\r\n      let gravity = 600;\r\n      let velocityBase = $fullScreen.height() * 0.6 + 320;\r\n      let velocity = randomNumber(velocityBase * 0.85, velocityBase * 1.15);\r\n\r\n      gsap.set(targets, {\r\n        left: xFrom,\r\n        bottom: defaults.offscreen,\r\n      });\r\n\r\n      if (config.reaction.directional) {\r\n        gsap.set(targets, {\r\n          scaleX: directionRatio,\r\n        });\r\n      }\r\n\r\n      tl.to(\r\n        targets,\r\n        {\r\n          rotation: 360 * directionRatio,\r\n          duration: 1,\r\n          repeat: -1,\r\n          ease: \"none\",\r\n        },\r\n        0\r\n      )\r\n        .to(\r\n          targets,\r\n          {\r\n            duration: 30,\r\n            physics2D: {\r\n              velocity: velocity,\r\n              // velocity: 600,\r\n              // angle: \"random(250, 290)\",\r\n              angle: angleToCenter + randomNumber(-10, 10),\r\n              gravity: gravity,\r\n            },\r\n          },\r\n          0\r\n        )\r\n        .fadeAndRemove(targets);\r\n\r\n      return tl;\r\n    },\r\n  });\r\n\r\n  gsap.registerEffect({\r\n    name: \"shutdown\",\r\n    effect: (targets, config) => {\r\n      let tl = gsap.timeline();\r\n\r\n      let $fullScreen = config.parent;\r\n\r\n      let $modalBG = $('<div class=\"cgw modal\"></div>').appendTo($fullScreen);\r\n      gsap.set($modalBG, {\r\n        top: 0,\r\n        left: 0,\r\n        width: \"100vw\",\r\n        height: \"100vh\",\r\n        backgroundColor: config.reaction.secondaryColor,\r\n        backdropFilter: \"blur(5px)\",\r\n        position: \"absolute\",\r\n        zIndex: 1000,\r\n      });\r\n\r\n      gsap.set(targets, {\r\n        left: \"50%\",\r\n        top: \"50%\",\r\n        xPercent: -50,\r\n        yPercent: -50,\r\n        fontSize: \"50vh\",\r\n      });\r\n\r\n      game.togglePause(true);\r\n      tl.to(targets, {\r\n        rotation: 5,\r\n        // duration: 10,\r\n        // repeat: -1,\r\n        ease: \"shake\",\r\n      })\r\n        .fadeAndRemove(targets, { duration: 1 }, 4)\r\n        .fadeAndRemove($modalBG, { duration: 1 }, 4);\r\n\r\n      return tl;\r\n    },\r\n  });\r\n}\r\n","import { id as moduleId } from \"../../../public/module.json\";\r\nimport { getReactionHTML } from \"./utils\";\r\n\r\nexport async function registerHelpers() {\r\n  Handlebars.registerHelper(\"reactionPreview\", (reaction) => {\r\n    let html = getReactionHTML(reaction);\r\n    return new Handlebars.SafeString(html);\r\n  });\r\n\r\n  Handlebars.registerHelper(\"last_x\", (array, count) => {\r\n    array = array.slice(-count);\r\n    return array;\r\n  });\r\n\r\n  Handlebars.registerHelper(\"add\", (input, add) => {\r\n    return parseInt(input) + parseInt(add);\r\n  });\r\n\r\n  Handlebars.registerHelper(\"eq\", (arg1, arg2) => {\r\n    return arg1 == arg2;\r\n  });\r\n}\r\n\r\nexport function loadPartials() {\r\n  let partialsList = [\r\n    `modules/${moduleId}/templates/parts/ReactionRow.hbs`,\r\n    `modules/${moduleId}/templates/parts/ReactionButtonBar.hbs`,\r\n  ];\r\n  loadTemplates(partialsList);\r\n}\r\n","import { registerSettings } from \"./settings\";\r\nimport { id as moduleId } from \"../../../public/module.json\";\r\nimport { registerSocketEvents, sendReactionToSocket } from \"./socket\";\r\nimport { loadPartials, registerHelpers } from \"./handlebars\";\r\nimport {\r\n  getReactionObject,\r\n  getReactionPNGUrl,\r\n  saveAllReactionPNGs,\r\n  renderChatButtonBar,\r\n} from \"./utils\";\r\n\r\nimport { ReactionSetupMenu } from \"./ReactionSetupMenu\";\r\n\r\nexport default function registerHooks() {\r\n  Hooks.once(\"init\", async function () {\r\n    console.log(\"CrowdGoesWild Init\");\r\n    registerSocketEvents();\r\n    registerSettings();\r\n    loadPartials();\r\n    registerHelpers();\r\n    // CONFIG.debug.hooks = true\r\n  });\r\n\r\n  Hooks.once(\"ready\", async function () {\r\n    if (game.user.isGM) {\r\n      saveAllReactionPNGs();\r\n    }\r\n    exposeForMacros();\r\n    // resetDefaultReactions()\r\n    // let rm = new ReactionSetupMenu({}).render(true);\r\n  });\r\n\r\n  Hooks.on(\"hotbarDrop\", async function (bar, data, slot) {\r\n    if (data.type == \"reaction\") {\r\n      let reactionId = data.id;\r\n      let droppedReaction = await getReactionObject(reactionId);\r\n      // let reactions = await game.settings.get(moduleId, 'reactions') as []\r\n      // let droppedReaction = reactions.find(r => r.id == args[1].id)\r\n      let newMacro = await Macro.create({\r\n        name: `Reaction - ${droppedReaction.title}`,\r\n        type: \"script\",\r\n        scope: \"global\",\r\n        img: await getReactionPNGUrl(reactionId),\r\n        command: `game.modules.get('crowdgoeswild').api.sendReaction(${reactionId})`,\r\n      });\r\n      game.user.assignHotbarMacro(newMacro, slot);\r\n    }\r\n  });\r\n\r\n  Hooks.on(\"updateSetting\", async function (oldSetting, newData, opts) {\r\n    if (oldSetting.key === \"crowdgoeswild.reactions\") {\r\n      renderChatButtonBar();\r\n    }\r\n  });\r\n\r\n  Hooks.on(\"renderSidebarTab\", async (app, html, data) => {\r\n    console.log(\"Rendered sidebar tab\");\r\n    if (app.tabName !== \"chat\") return;\r\n    renderChatButtonBar();\r\n\r\n    //Stress testing. Don't turn this on. Probably.\r\n    // setTimeout(()=>{\r\n    //     for (let index = 0; index < 1000; index++) {\r\n    //         setTimeout(()=>sendReactionToSocket({icon: \"heart\", color: \"#eb34b1\", effect: \"floatUp\"}), randomNumber(0, 100))\r\n    //     }\r\n    // }, 4000)\r\n  });\r\n\r\n  // Hooks.on(\"getSceneControlButtons\", controls => {\r\n  //     console.log(controls)\r\n  //     controls = addButtons(controls)\r\n  // });\r\n}\r\n\r\nfunction exposeForMacros() {\r\n  game.modules.get(moduleId).api = {\r\n    sendReaction(reactionId) {\r\n      sendReactionToSocket(reactionId);\r\n    },\r\n  };\r\n}\r\n","import \"../../styles/crowdgoeswild.scss\"\r\nimport { animationInit } from \"./animation\";\r\nimport registerHooks from \"./hooks\"\r\n\r\ndeclare global {\r\n    interface LenientGlobalVariableTypes {\r\n        game: never; // the type doesn't matter\r\n    }\r\n}\r\n\r\nconst referenceToGame: Game = game; // ok! :)\r\n\r\nregisterHooks()\r\nanimationInit()\r\n\r\n// buttons for reactions\r\n// send reaction to other clients\r\n// display reaction from all clients\r\n"],"names":["process","dataURL","id","cache","moduleId","htmlToImage.toPng"],"mappings":"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"}